<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABI fish & pets - Nepal's</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2e7d32;
            --primary-dark: #1b5e20;
            --primary-light: #4caf50;
            --secondary: #ff9800;
            --secondary-dark: #ef6c00;
            --accent: #2196f3;
            --danger: #f44336;
            --danger-dark: #d32f2f;
            --text: #333;
            --text-light: #666;
            --bg: #f8fdf8;
            --card: #ffffff;
            --shadow: rgba(0, 0, 0, 0.08);
            --border: #e0f2e1;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Poppins', sans-serif;
        }
        
        body {
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        /* Header with Custom Logo */
        .header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(46, 125, 50, 0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-circle {
            width: 45px;
            height: 45px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .logo-circle i {
            font-size: 22px;
            color: var(--primary);
        }
        
        .logo-circle img{
            width:30px;
            height:30px;
            object-fit:contain;
        }
        
        .logo-text {
            font-size: 22px;
            font-weight: 800;
            letter-spacing: 0.5px;
        }
        
        .logo-tagline {
            font-size: 11px;
            opacity: 0.9;
            margin-top: -2px;
            font-weight: 300;
        }
        
        .user-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-profile {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid rgba(255,255,255,0.3);
        }
        
        .user-profile:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
        
        /* My Listings Button */
        .my-listings-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center ;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .my-listings-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* Admin Control Button */
        .admin-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center ;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .admin-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* Auth Modal - Modern Design */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        
        .auth-content {
            background: var(--card);
            width: 90%;
            max-width: 420px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: slideUp 0.4s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .auth-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 25px;
            text-align: center;
            color: white;
        }
        
        .auth-header h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .auth-tabs {
            display: flex;
            background: #f5f5f5;
        }
        
        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 18px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            color: var(--text-light);
        }
        
        .auth-tab.active {
            background: white;
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        .auth-body {
            padding: 30px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
            font-size: 14px;
        }
        
        .input-with-icon {
            position: relative;
        }
        
        .input-with-icon i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
        }
        
        .auth-input {
            width: 100%;
            padding: 14px 14px 14px 45px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
            background: #fcfcfc;
        }
        
        .auth-input:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }
        
        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Hero Section */
        .hero-section {
            background: linear-gradient(rgba(255,255,255,0.9), rgba(255,255,255,0.9)), 
                        url('https://images.unsplash.com/photo-1417733403748-83bbc7c05140?q=80&w=1000');
            background-size: cover;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px var(--shadow);
            border: 1px solid var(--border);
        }
        
        .hero-title {
            font-size: 32px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .hero-subtitle {
            font-size: 16px;
            color: var(--text-light);
            max-width: 600px;
            margin: 0 auto 25px;
        }
        
        /* Search and Filter */
        .search-section {
            background: var(--card);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px var(--shadow);
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }
        
        .search-box i {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
        }
        
        .search-box input {
            width: 100%;
            padding: 16px 20px 16px 50px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }
        
        /* Category Filters */
        .category-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .category-btn {
            padding: 12px 24px;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .category-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }
        
        .category-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Listing Cards - Enhanced Design */
        .listings {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .listing-card {
            background: var(--card);
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 8px 25px var(--shadow);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
            border: 1px solid var(--border);
            position: relative;
        }
        
        .listing-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(46, 125, 50, 0.15);
        }
        
        .listing-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--secondary);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 2;
        }
        
        .listing-img {
            height: 200px;
            position: relative;
            overflow: hidden;
        }
        
        .listing-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }
        
        .listing-card:hover .listing-img img {
            transform: scale(1.05);
        }
        
        .img-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #e8f5e9, #c8e6c9);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }
        
        .listing-details {
            padding: 20px;
        }
        
        .listing-price {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .listing-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text);
        }
        
        .listing-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 13px;
            color: var(--text-light);
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .seller-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .seller-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }
        
        .seller-details {
            flex: 1;
        }
        
        .seller-name {
            font-weight: 600;
            font-size: 14px;
        }
        
        .seller-phone {
            font-size: 12px;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #f0f7ff;
            color: var(--accent);
            border: 2px solid #e3f2fd;
        }
        
        .btn-secondary:hover {
            background: #e3f2fd;
        }
        
        .btn-edit {
            background: #fff3e0;
            color: var(--secondary);
            border: 2px solid #ffe0b2;
        }
        
        .btn-edit:hover {
            background: #ffe0b2;
        }
        
        .btn-delete {
            background: #ffebee;
            color: var(--danger);
            border: 2px solid #ffcdd2;
        }
        
        .btn-delete:hover {
            background: #ffcdd2;
        }
        
        .btn-block {
            background: #ffebee;
            color: var(--danger);
            border: 2px solid #ffcdd2;
        }
        
        .btn-block:hover {
            background: #ffcdd2;
        }
        
        .btn-admin {
            background: #673ab7;
            color: white;
            border: 2px solid #5e35b1;
        }
        
        .btn-admin:hover {
            background: #5e35b1;
        }
        
        /* Owner Actions */
        .owner-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        
        .owner-btn {
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            flex: 1;
        }
        
        /* Admin Actions */
        .admin-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            border-top: 1px dashed #ddd;
            padding-top: 10px;
        }
        
        /* Sell Button - Attractive Design */
        .sell-btn-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 999;
        }
        
        .sell-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4);
            transition: all 0.3s;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4); }
            50% { box-shadow: 0 8px 30px rgba(255, 152, 0, 0.6); }
            100% { box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4); }
        }
        
        .sell-btn:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        /* Sell Modal - Attractive Design */
        .sell-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        
        .sell-content {
            background: var(--card);
            width: 90%;
            max-width: 500px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            animation: slideUp 0.4s ease;
        }
        
        .sell-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 25px;
            text-align: center;
            color: white;
            position: relative;
        }
        
        .sell-header h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .sell-header i {
            position: absolute;
      right: 25px;
            top: 25px;
            font-size: 20px;
            cursor: pointer;
            opacity: 0.8;
        }
        
        .sell-header i:hover {
            opacity: 1;
        }
        
        .sell-body {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
        }
        
        .form-control {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }
        
        /* Image Upload */
        .image-upload-area {
            border: 2px dashed var(--primary);
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f8fff8;
        }
        
        .image-upload-area:hover {
            background: #f0fff0;
            border-color: var(--primary-dark);
        }
        
        .upload-icon {
            font-size: 40px;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
              /* Delete Confirmation Modal */
        .confirm-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            z-index: 2100;
        }
        
        .confirm-content {
            background: var(--card);
            width: 90%;
            max-width: 400px;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .confirm-icon {
            font-size: 50px;
            color: var(--danger);
            margin-bottom: 20px;
        }
        
        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: var(--card);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px var(--shadow);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 28px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 13px;
            color: var(--text-light);
        }
        
        /* Footer */
        .footer {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: white;
            padding: 40px 20px;
            text-align: center;
            margin-top: 50px;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .listings {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .search-section {
                flex-direction: column;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .hero-title {
                font-size: 24px;
            }
        }
        
        /* WhatsApp Button Color */
        .btn-whatsapp {
            background: #25D366 !important;
            color: white !important;
            border: none !important;
        }
        
        .btn-whatsapp:hover {
            background: #128C7E !important;
            transform: translateY(-2px);
        }
        
        /* WhatsApp Icon */
        .fa-whatsapp {
            font-size: 16px;
        }
        
        /* Images Grid Layout */
        .images-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2px;
            height: 200px;
            overflow: hidden;
        }
        
        /* Login/Register Link */
        .auth-switch-link {
            text-align: center;
            margin-top: 20px;
            color: var(--text-light);
            font-size: 14px;
        }
        
        .auth-switch-link a {
            color: var(--primary);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
        }
        
        .auth-switch-link a:hover {
            text-decoration: underline;
        }
        
        /* User Menu Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* User Type Selection */
        .user-type-selection {
            display: flex;
            gap: 10px;
            margin-top: 8px;
        }
        
        .user-type-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            background: #f8f9fa;
            text-align: center;
            transition: all 0.3s;
        }
        
        .user-type-btn:hover {
            border-color: var(--primary);
        }
        
        .user-type-btn.selected {
            border-color: var(--primary) !important;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9) !important;
            color: var(--primary) !important;
        }
        
        .user-type-btn i {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .user-type-btn strong {
            display: block;
            margin-bottom: 5px;
        }
        
        .user-type-btn small {
            font-size: 11px;
            color: #666;
        }
        
        /* Back Button */
        .back-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 auto;
        }
        
        .back-btn:hover {
            background: #5a6268;
        }
    </style>
</head>
<body>
      <!-- Header -->
    <div class="header">
        <div class="logo-container">
            <div class="logo-circle">
                <img src="logo1.png" alt="Logo" style="width: 45px; height: 45px;">
            </div>
            <div>
                <div class="logo-text">ABI Fish & Pets</div>
                <div class="logo-tagline">Nepal's Trusted Pet Marketplace</div>
            </div>
        </div>
        
        <div class="user-section">
            <button class="admin-btn" onclick="openAdminPanel()" id="adminBtn" style="display: none;">
                <i class="fas fa-cog"></i> Admin Panel
            </button>
            <button class="my-listings-btn" onclick="showMyListings()" id="myListingsBtn" style="display: none;">
                <i class="fas fa-list"></i> My Listings
            </button>
            <div class="user-profile" onclick="toggleAuthModal()" id="userInitial">
                <i class="fas fa-user"></i>
            </div>
        </div>
    </div>    
    
    <!-- Auth Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-content">
            <div class="auth-header">
                <h2>Welcome Back!</h2>
                <p>Sign in to buy or sell pets</p>
            </div>
            
            <div class="auth-tabs">
                <div class="auth-tab active" onclick="switchAuthTab('login')">Login</div>
                <div class="auth-tab" onclick="switchAuthTab('register')">Register</div>
            </div>
            
            <div class="auth-body">
                <div id="loginForm">
                    <div class="input-group">
                        <label>Email Address</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" class="auth-input" id="loginEmail" placeholder="you@example.com">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Password</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" class="auth-input" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="login()">
                        <i class="fas fa-sign-in-alt"></i> Sign In
                    </button>
                    
                    <div class="auth-switch-link">
                        New user? <a href="javascript:void(0)" onclick="switchAuthTab('register')">Create an account</a>
                    </div>
                    
                    <!-- Admin Login Hint -->
                    <div style="margin-top: 20px; padding: 10px; background: #fff3e0; border-radius: 8px; border-left: 4px solid #ff9800;">
                        <small style="color: #666;">
                            <i class="fas fa-info-circle"></i> <strong>Admin Login:</strong><br>
                        </small>
                    </div>
                </div>            
                
                <div id="registerForm" style="display: none;">
                    <div class="input-group">
                        <label>Full Name</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" class="auth-input" id="regName" placeholder="John Doe">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Email Address</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" class="auth-input" id="regEmail" placeholder="you@example.com">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Phone Number</label>
                        <div class="input-with-icon">
                            <i class="fas fa-phone"></i>
                            <input type="tel" class="auth-input" id="regPhone" placeholder="97XXXXXXXX or 98XXXXXXXX">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Account Type *</label>
                        <div class="user-type-selection">
                            <button type="button" class="user-type-btn" onclick="selectUserType('customer')">
                                <i class="fas fa-user"></i><br>
                                <strong>Customer</strong><br>
                                <small>Only buy pets</small>
                            </button>
                            <button type="button" class="user-type-btn" onclick="selectUserType('seller')">
                                <i class="fas fa-store"></i><br>
                                <strong>Seller</strong><br>
                                <small>Sell & buy pets</small>
                            </button>
                        </div>
                        <input type="hidden" id="userType" value="customer">
                    </div>
                    
                    <div class="input-group">
                        <label>Password</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" class="auth-input" id="regPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="register()">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                    
                    <div class="auth-switch-link">
                        Already have an account? <a href="javascript:void(0)" onclick="switchAuthTab('login')">Sign in</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Delete Confirmation Modal -->
    <div class="confirm-modal" id="deleteModal">
        <div class="confirm-content">
            <div class="confirm-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 style="margin-bottom: 10px; color: var(--danger);">Delete Listing</h3>
            <p id="deleteMessage" style="margin-bottom: 25px; color: var(--text-light);">
                Are you sure you want to delete this listing?
            </p>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn btn-secondary" onclick="closeDeleteModal()" style="min-width: 100px;">
                    Cancel
                </button>
                <button class="btn" onclick="confirmDelete()" 
                        style="background: var(--danger); color: white; min-width: 100px;">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        </div>
    </div>
    
    <!-- Block Confirmation Modal -->
    <div class="confirm-modal" id="blockModal">
        <div class="confirm-content">
            <div class="confirm-icon">
                <i class="fas fa-ban" style="color: #ff9800;"></i>
            </div>
            <h3 style="margin-bottom: 10px; color: #ff9800;">Block User</h3>
            <p id="blockMessage" style="margin-bottom: 25px; color: var(--text-light);">
                Are you sure you want to block this user?
            </p>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn btn-secondary" onclick="closeBlockModal()" style="min-width: 100px;">
                    Cancel
                </button>
                <button class="btn" onclick="confirmBlock()" 
                        style="background: #ff9800; color: white; min-width: 100px;">
                    <i class="fas fa-ban"></i> Block
                </button>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="container">
        <!-- Hero Section -->
        <div class="hero-section">
            <h1 class="hero-title">Find Your Perfect Pet Companion</h1>
            <p class="hero-subtitle">Buy, sell, or adopt pets in Nepal's largest pet marketplace. Connect with trusted sellers and find your furry, feathery, or scaly friend today!</p>
        </div>
        
        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-number" id="totalPets">0</div>
                <div class="stat-label">Pets Available</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="myListingsCount">0</div>
                <div class="stat-label">My Listings</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">2.5%</div>
                <div class="stat-label">Admin Commission</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="cities">15+</div>
                <div class="stat-label">Cities Across Nepal</div>
            </div>
        </div>
        
        <!-- Search Section -->
        <div class="search-section">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Search for pets, breeds, or sellers...">
            </div>
            
            <select class="form-control" style="min-width: 180px;" id="locationFilter">
                <option value="">All Locations</option>
                <option value="kathmandu">Kathmandu</option>
                <option value="pokhara">Pokhara</option>
                <option value="biratnagar">Biratnagar</option>
                <option value="butwal">Butwal</option>
                <option value="chitwan">Chitwan</option>
            </select>
            
            <select class="form-control" style="min-width: 150px;" id="priceFilter">
                <option value="">Any Price</option>
                <option value="low">Under ‡§∞‡•Å 5,000</option>
                <option value="medium">‡§∞‡•Å 5,000 - 20,000</option>
                <option value="high">Over ‡§∞‡•Å 20,000</option>
            </select>
        </div>
        
        <!-- Category Filters -->
        <div class="category-filters">
            <div class="category-btn active" onclick="filterByCategory('all')">
                <i class="fas fa-paw"></i> All Pets
            </div>
            <div class="category-btn" onclick="filterByCategory('dog')">
                <i class="fas fa-dog"></i> Dogs
            </div>
            <div class="category-btn" onclick="filterByCategory('cat')">
                <i class="fas fa-cat"></i> Cats
            </div>
            <div class="category-btn" onclick="filterByCategory('fish')">
                <i class="fas fa-fish"></i> Fish
            </div>
            <div class="category-btn" onclick="filterByCategory('bird')">
                <i class="fas fa-dove"></i> Birds
            </div>
            <div class="category-btn" onclick="filterByCategory('other')">
                <i class="fas fa-dragon"></i> Others
            </div>
        </div>
        
        <!-- Listings Grid -->
        <div class="listings" id="listingsContainer">
            <!-- Listings loaded by JavaScript -->
        </div>
    </div>
    
    <!-- Sell Button -->
    <div class="sell-btn-container">
        <div class="sell-btn" onclick="openSellModal()">
            <i class="fas fa-plus"></i>
        </div>
    </div>
    
    <!-- Sell Modal -->
    <div class="sell-modal" id="sellModal">
        <div class="sell-content">
            <div class="sell-header">
                <h2 id="sellModalTitle">Sell Your Pet</h2>
                <p id="sellModalSubtitle">List your pet in just 2 minutes</p>
                <i class="fas fa-times" onclick="closeSellModal()"></i>
            </div>
            
            <div class="sell-body">
                <input type="hidden" id="editListingId" value="">
                
                <div class="form-group">
                    <label class="form-label">Pet Name/Title *</label>
                    <input type="text" class="form-control" id="petTitle" placeholder="e.g., Golden Retriever Puppy">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Category *</label>
                    <select class="form-control" id="petCategory">
                        <option value="">Select Category</option>
                        <option value="dog">Dog</option>
                        <option value="cat">Cat</option>
                        <option value="fish">Fish</option>
                        <option value="bird">Bird</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Price (NPR) *</label>
                    <input type="number" class="form-control" id="petPrice" placeholder="e.g., 15000">
                    <div id="commissionInfo" style="margin-top: 8px; font-size: 13px; color: var(--text-light);"></div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Description *</label>
                    <textarea class="form-control" id="petDescription" rows="3" placeholder="Describe your pet"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Location *</label>
                    <input type="text" class="form-control" id="petLocation" placeholder="e.g., Kathmandu">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Contact Phone *</label>
                    <input type="tel" class="form-control" id="petPhone" placeholder="97XXXXXXXX or 98XXXXXXXX">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Pet Images (Optional)</label>
                    <div class="image-upload-area" onclick="document.getElementById('imageUpload').click()">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div style="font-weight: 600; color: var(--primary);">Click to Upload Images</div>
                        <div style="font-size: 13px; color: var(--text-light);">Upload clear photos (Max 5)</div>
                    </div>
                    <input type="file" id="imageUpload" accept="image/*" multiple style="display: none;" onchange="handleImageUpload(event)">
                    <div id="imagePreview" style="margin-top: 15px; display: flex; flex-wrap: wrap; gap: 10px;"></div>
                </div>
                
                <button class="btn btn-primary" style="width: 100%; padding: 16px; font-size: 16px; margin-top: 20px;" 
                        onclick="submitListing()" id="submitListingBtn">
                    <i class="fas fa-paper-plane"></i> Publish Listing
                </button>
            </div>
        </div>
    </div>
    
    <!-- Admin Panel Modal -->
    <div class="auth-modal" id="adminModal">
        <div class="auth-content">
            <div class="auth-header">
                <h2>Admin Panel</h2>
                <p>Manage users and listings</p>
            </div>
            
            <div class="auth-body">
                <div style="margin-bottom: 20px;">
                    <h3 style="margin-bottom: 15px; color: var(--primary);">All Users</h3>
                    <div id="adminUsersList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 8px; padding: 10px;">
                        <!-- Users will be loaded here -->
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h3 style="margin-bottom: 15px; color: var(--primary);">All Listings</h3>
                    <div id="adminListingsList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 8px; padding: 10px;">
                        <!-- Listings will be loaded here -->
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="closeAdminPanel()">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-content">
            <div style="font-size: 24px; font-weight: 800; margin-bottom: 20px;">ABI Fish & Pets</div>
            <div style="max-width: 600px; margin: 0 auto 30px; opacity: 0.9;">
                Nepal's most trusted platform for buying and selling pets. Connecting pet lovers since 2021.
            </div>
            <div style="display: flex; justify-content: center; gap: 20px; margin-bottom: 30px;">
                <a href="#" style="color: white; opacity: 0.8; transition: opacity 0.3s;">About Us</a>
                <a href="#" style="color: white; opacity: 0.8; transition: opacity 0.3s;">Contact : 9703710719</a>
                <a href="#" style="color: white; opacity: 0.8; transition: opacity 0.3s;">Privacy Policy</a>
                <a href="#" style="color: white; opacity: 0.8; transition: opacity 0.3s;">Terms of Service</a>
            </div>
            <div style="opacity: 0.7; font-size: 14px;">
                ¬© 2024 ABI Fish & Pets. Thankyou for choosing us.üôèüíê
            </div>
        </div>
    </div>
<script>
    // ==================== DATA & STATE ====================
    let currentUser = null;
    let listings = JSON.parse(localStorage.getItem('petListings')) || [];
    let uploadedImages = [];
    let listingToDelete = null;
    let userToBlock = null;
    const ADMIN_COMMISSION_RATE = 2.5;
    
    // ==================== INITIALIZATION ====================
    document.addEventListener('DOMContentLoaded', function() {
        // Check if data exists, if not initialize with sample data
        if (!localStorage.getItem('petListings') || JSON.parse(localStorage.getItem('petListings')).length === 0) {
            initializeSampleData();
        }
        
        if (!localStorage.getItem('users')) {
            initializeUsers();
        }
        
        loadListings();
        checkAuthStatus();
        setupEventListeners();
    });
    
    function initializeSampleData() {
        // Create admin user first
        const adminUser = {
            id: 'admin_001',
            name: 'Admin User',
            email: 'admin@abifishpets.com',
            phone: '9703710719',
            password: 'admin123',
            location: 'Kathmandu',
            userType: 'admin',
            createdAt: new Date().toISOString(),
            isActive: true
        };
        
        // Create some sample users
        const sampleUsers = [
            adminUser,
            {
                id: 'user_001',
                name: 'John Doe',
                email: 'john@example.com',
                phone: '9812345678',
                password: 'password123',
                location: 'Kathmandu',
                userType: 'seller',
                createdAt: new Date().toISOString(),
                isActive: true
            },
            {
                id: 'user_002',
                name: 'Jane Smith',
                email: 'jane@example.com',
                phone: '9823456789',
                password: 'password123',
                location: 'Pokhara',
                userType: 'customer',
                createdAt: new Date().toISOString(),
                isActive: true
            }
        ];
        
        localStorage.setItem('users', JSON.stringify(sampleUsers));
        
        // Create sample listings
        const sampleListings = [
            {
                id: 1,
                title: "Golden Retriever Puppy",
                price: 25000,
                category: "dog",
                description: "3 month old golden retriever puppy, vaccinated and healthy.",
                location: "Kathmandu",
                sellerName: "John Doe",
                sellerId: "user_001",
                sellerPhone: "9812345678",
                date: "2024-01-15",
                images: [],
                commission: 625,
                sellerGets: 24375,
                createdAt: new Date().toISOString(),
                isActive: true
            },
            {
                id: 2,
                title: "Persian Cat",
                price: 18000,
                category: "cat",
                description: "Beautiful white persian cat, 6 months old.",
                location: "Pokhara",
                sellerName: "Jane Smith",
                sellerId: "user_002",
                sellerPhone: "9823456789",
                date: "2024-01-14",
                images: [],
                commission: 450,
                sellerGets: 17550,
                createdAt: new Date().toISOString(),
                isActive: true
            },
            {
                id: 3,
                title: "Halfmoon Betta Fish",
                price: 450,
                category: "fish",
                description: "Beautiful halfmoon Betta fish, vibrant colors.",
                location: "Kathmandu",
                sellerName: "John Doe",
                sellerId: "user_001",
                sellerPhone: "9812345678",
                date: "2024-01-13",
                images: [],
                commission: 11.25,
                sellerGets: 438.75,
                createdAt: new Date().toISOString(),
                isActive: true
            }
        ];
        
        localStorage.setItem('petListings', JSON.stringify(sampleListings));
        listings = sampleListings;
        
        showNotification("Sample data initialized!", 'success');
    }
    
    function initializeUsers() {
        const users = [
            {
                id: 'admin_001',
                name: 'Admin User',
                email: 'admin@abifishpets.com',
                phone: '9703710719',
                password: 'admin123',
                location: 'Kathmandu',
                userType: 'admin',
                createdAt: new Date().toISOString(),
                isActive: true
            }
        ];
        localStorage.setItem('users', JSON.stringify(users));
    }
    
    function setupEventListeners() {
        document.getElementById('petPrice').addEventListener('input', updatePriceDisplay);
        
        document.getElementById('searchInput').addEventListener('input', function(e) {
            filterListings();
        });
        
        document.getElementById('locationFilter').addEventListener('change', filterListings);
        document.getElementById('priceFilter').addEventListener('change', filterListings);
    }
    
    function filterListings() {
        const term = document.getElementById('searchInput').value.toLowerCase();
        const location = document.getElementById('locationFilter').value;
        const priceFilter = document.getElementById('priceFilter').value;
        
        const container = document.getElementById('listingsContainer');
        container.innerHTML = '';
        
        const filtered = listings.filter(listing => {
            if (term && !listing.title.toLowerCase().includes(term) && 
                !listing.description.toLowerCase().includes(term) &&
                !listing.sellerName.toLowerCase().includes(term)) {
                return false;
            }
            
            if (location && !listing.location.toLowerCase().includes(location)) {
                return false;
            }
            
            if (priceFilter) {
                if (priceFilter === 'low' && listing.price >= 5000) return false;
                if (priceFilter === 'medium' && (listing.price < 5000 || listing.price > 20000)) return false;
                if (priceFilter === 'high' && listing.price <= 20000) return false;
            }
            
            return true;
        });
        
        if (filtered.length === 0) {
            container.innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--text-light);">
                    <i class="fas fa-search" style="font-size: 50px; margin-bottom: 20px;"></i>
                    <h3>No Pets Found</h3>
                    <p>Try changing your search criteria</p>
                    <button class="btn btn-primary" onclick="loadListings()" style="margin-top: 10px;">
                        <i class="fas fa-redo"></i> Reset Filters
                    </button>
                </div>
            `;
            return;
        }
        
        filtered.forEach(listing => {
            const card = createListingCard(listing);
            container.innerHTML += card;
        });
    }
    
    // ==================== AUTHENTICATION ====================
    function toggleAuthModal() {
        const modal = document.getElementById('authModal');
        modal.style.display = modal.style.display === 'flex' ? 'none' : 'flex';
    }
    
    function switchAuthTab(tab) {
        document.getElementById('loginForm').style.display = tab === 'login' ? 'block' : 'none';
        document.getElementById('registerForm').style.display = tab === 'register' ? 'block' : 'none';
        
        document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
        event.target.classList.add('active');
        
        if (tab === 'register') {
            resetUserTypeSelection();
        }
    }
    
    function resetUserTypeSelection() {
        document.querySelectorAll('.user-type-btn').forEach(btn => {
            btn.classList.remove('selected');
        });
        document.querySelectorAll('.user-type-btn')[0].classList.add('selected');
        document.getElementById('userType').value = 'customer';
    }
    
    function selectUserType(type) {
        document.querySelectorAll('.user-type-btn').forEach(btn => {
            btn.classList.remove('selected');
        });
        event.target.classList.add('selected');
        document.getElementById('userType').value = type;
    }
    
    function login() {
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        
        if (!email || !password) {
            alert("Please enter email and password");
            return;
        }
const users = JSON.parse(localStorage.getItem('users')) || [];
        const user = users.find(u => u.email === email && u.password === password);
        
        if (!user) {
            alert("Invalid email or password");
            return;
        }
        
        if (!user.isActive) {
            alert("This account has been blocked. Please contact admin.");
            return;
        }
        
        currentUser = {
            id: user.id,
            name: user.name,
            email: user.email,
            phone: user.phone,
            location: user.location || "Kathmandu",
            userType: user.userType,
            createdAt: user.createdAt
        };
        
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        updateUserUI();
        toggleAuthModal();
        
        showNotification(`Welcome ${currentUser.name}!`, 'success');
    }
    
    function register() {
        const name = document.getElementById('regName').value;
        const email = document.getElementById('regEmail').value;
        const phone = document.getElementById('regPhone').value;
        const password = document.getElementById('regPassword').value;
        const userType = document.getElementById('userType').value;
        
        if (!name || !email || !phone || !password) {
            alert("Please fill all fields");
            return;
        }
        
        if (!phone.match(/^(97|98)\d{8}$/)) {
            alert("Please enter a valid Nepali phone number starting with 97 or 98");
            return;
        }
        
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            alert("Please enter a valid email address");
            return;
        }
        
        if (password.length < 6) {
            alert("Password must be at least 6 characters long");
            return;
        }
        
        const users = JSON.parse(localStorage.getItem('users')) || [];
        
        if (users.find(u => u.email === email)) {
            alert("Email already registered. Please login instead.");
            switchAuthTab('login');
            return;
        }
        
        if (users.find(u => u.phone === phone)) {
            alert("Phone number already registered");
            return;
        }
        
        const newUser = {
            id: 'user_' + Date.now(),
            name: name,
            email: email,
            phone: phone,
            password: password,
            location: "Kathmandu",
            userType: userType,
            createdAt: new Date().toISOString(),
            isActive: true
        };
        
        users.push(newUser);
        localStorage.setItem('users', JSON.stringify(users));
        
        currentUser = {
            id: newUser.id,
            name: newUser.name,
            email: newUser.email,
            phone: newUser.phone,
            location: newUser.location,
            userType: newUser.userType,
            createdAt: newUser.createdAt
        };
        
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        updateUserUI();
        toggleAuthModal();
        
        showNotification(`Account created successfully! Welcome ${name}.`, 'success');
    }
    
    function checkAuthStatus() {
        const savedUser = localStorage.getItem('currentUser');
        if (savedUser) {
            currentUser = JSON.parse(savedUser);
            updateUserUI();
        }
    }
    
    function logout() {
        if (confirm("Are you sure you want to logout?")) {
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateUserUI();
            showNotification("Logged out successfully", 'info');
            loadListings();
        }
    }
    
    function updateUserUI() {
        const userInitial = document.getElementById('userInitial');
        const myListingsBtn = document.getElementById('myListingsBtn');
        const adminBtn = document.getElementById('adminBtn');
        
        if (currentUser) {
            userInitial.innerHTML = currentUser.userType === 'admin' ? 
                `<i class="fas fa-crown"></i>` :
                currentUser.userType === 'seller' ? 
                `<i class="fas fa-store"></i>` : 
                `<i class="fas fa-user"></i>`;
            
            userInitial.onclick = function() {
                showUserMenu();
            };
            
            myListingsBtn.style.display = currentUser.userType === 'seller' ? 'flex' : 'none';
            adminBtn.style.display = currentUser.userType === 'admin' ? 'flex' : 'none';
            
            updateMyListingsCount();
        } else {
            userInitial.innerHTML = `<i class="fas fa-user"></i>`;
            userInitial.onclick = toggleAuthModal;
            myListingsBtn.style.display = 'none';
            adminBtn.style.display = 'none';
        }
    }
    
    function showUserMenu() {
        if (!currentUser) return;
        
        const menu = document.createElement('div');
        menu.style.cssText = `
            position: absolute;
            top: 60px;
            right: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            padding: 15px;
            min-width: 200px;
            z-index: 2001;
            animation: fadeIn 0.2s ease;
        `;
        
        menu.innerHTML = `
            <div style="padding: 10px; border-bottom: 1px solid #eee;">
                <div style="font-weight: bold;">${currentUser.name}</div>
                <div style="font-size: 12px; color: #666;">${currentUser.email}</div>
                <div style="font-size: 11px; color: #888; margin-top: 5px;">
                    <i class="fas fa-${currentUser.userType === 'admin' ? 'crown' : currentUser.userType === 'seller' ? 'store' : 'user'}"></i>
                    ${currentUser.userType === 'admin' ? 'Admin' : currentUser.userType === 'seller' ? 'Seller' : 'Customer'}
                </div>
            </div>
            <div style="padding: 10px;">
                <button onclick="showMyProfile()" class="user-menu-item">
                    <i class="fas fa-user-circle"></i> My Profile
                </button>
                ${currentUser.userType === 'seller' ? 
                    `<button onclick="showMyListings()" class="user-menu-item">
                        <i class="fas fa-list"></i> My Listings
                    </button>` : ''
                }
                ${currentUser.userType === 'admin' ? 
                    `<button onclick="openAdminPanel()" class="user-menu-item">
                        <i class="fas fa-cog"></i> Admin Panel
                    </button>` : ''
                }
                <button onclick="logout()" class="user-menu-item" style="color: #f44336;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        `;
        
        menu.onclick = function(e)
          {
            e.stopPropagation();
        };
        
        document.body.appendChild(menu);
        
        const closeMenu = function() {
            if (document.body.contains(menu)) {
                document.body.removeChild(menu);
                document.removeEventListener('click', closeMenu);
            }
        };
        
        setTimeout(closeMenu, 5000);
        document.addEventListener('click', closeMenu);
    }
    
    function showMyProfile() {
        if (!currentUser) return;
        alert(`My Profile\n\nName: ${currentUser.name}\nEmail: ${currentUser.email}\nPhone: ${currentUser.phone}\nAccount Type: ${currentUser.userType}\nJoined: ${new Date(currentUser.createdAt).toLocaleDateString()}`);
    }
    
    function showMyListings() {
        if (!currentUser) {
            alert("Please login first");
            toggleAuthModal();
            return;
        }
        
        if (currentUser.userType !== 'seller') {
            alert("Only sellers can view their listings");
            return;
        }
        
        const myListings = listings.filter(l => l.sellerId === currentUser.id);
        const container = document.getElementById('listingsContainer');
        container.innerHTML = '';
        
        if (myListings.length === 0) {
            container.innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--text-light);">
                    <i class="fas fa-box-open" style="font-size: 50px; margin-bottom: 20px;"></i>
                    <h3>No Listings Yet</h3>
                    <p>You haven't listed any pets for sale.</p>
                    <button class="btn btn-primary" onclick="openSellModal()" style="margin-top: 20px;">
                        <i class="fas fa-plus"></i> Sell Your First Pet
                    </button>
                    <button class="btn btn-secondary" onclick="loadListings()" style="margin-top: 10px;">
                        <i class="fas fa-arrow-left"></i> Back to All Listings
                    </button>
                </div>
            `;
            return;
        }
        
        myListings.forEach(listing => {
            const card = createListingCard(listing);
            container.innerHTML += card;
        });
        
        const backButton = document.createElement('div');
        backButton.style.cssText = `
            grid-column: 1/-1;
            text-align: center;
            margin-top: 20px;
        `;
        backButton.innerHTML = `
            <button class="btn btn-secondary" onclick="loadListings()">
                <i class="fas fa-arrow-left"></i> Back to All Listings
            </button>
            <div style="margin-top: 10px; color: var(--text-light);">
                Showing ${myListings.length} of your listings
            </div>
        `;
        container.appendChild(backButton);
    }
    
    // ==================== LISTINGS ====================
    function loadListings() {
        const container = document.getElementById('listingsContainer');
        container.innerHTML = '';
        
        // Reset filters
        document.getElementById('searchInput').value = '';
        document.getElementById('locationFilter').value = '';
        document.getElementById('priceFilter').value = '';
        
        // Update active category button
        document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
        document.querySelectorAll('.category-btn')[0].classList.add('active');
        
        if (listings.length === 0) {
            container.innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--text-light);">
                    <i class="fas fa-paw" style="font-size: 50px; margin-bottom: 20px;"></i>
                    <h3>No Pets Available</h3>
                    <p>Be the first to list a pet for sale!</p>
                    <button class="btn btn-primary" onclick="openSellModal()" style="margin-top: 20px;">
                        <i class="fas fa-plus"></i> Sell Your First Pet
                    </button>
                </div>
            `;
        } else {
            listings.forEach(listing => {
                const card = createListingCard(listing);
                container.innerHTML += card;
            });
        }
        
        updateStats();
    }
    
    function createListingCard(listing) {
        const icon = getCategoryIcon(listing.category);
        const placeholderColor = getCategoryColor(listing.category);
        const commission = listing.price * (ADMIN_COMMISSION_RATE/100);
        const sellerGets = listing.price - commission;
        const isOwner = currentUser && listing.sellerId === currentUser.id;
        const isAdmin = currentUser && currentUser.userType === 'admin';
        
        // 3 ‡§ì‡§ü‡§æ images ‡§¶‡•á‡§ñ‡§æ‡§â‡§®‡•á
        const displayImages = listing.images && listing.images.length > 0 ? 
            listing.images.slice(0, 3) : [];
        
        return `
            <div class="listing-card" data-category="${listing.category}" data-id="${listing.id}">
                <div class="listing-badge">${getCategoryName(listing.category)}</div>
                
                <!-- 3 ‡§ì‡§ü‡§æ Images Display -->
                <div class="listing-img">
                    ${displayImages.length > 0 ? 
                        `<div style="display: grid; grid-template-columns: repeat(${Math.min(displayImages.length, 3)}, 1fr); gap: 2px; height: 100%;">
                            ${displayImages.map((img, index) => `
                                <div style="overflow: hidden; position: relative; ${displayImages.length === 1 ? 'grid-column: 1/-1;' : ''}">
                                    <img src="${img}" alt="${listing.title} ${index + 1}" 
                                         style="width: 100%; height: 100%; object-fit: cover;">
                                    ${displayImages.length > 1 && index === 2 && listing.images.length > 3 ? 
                                        `<div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: bold;">
                                            +${listing.images.length - 3}
                                        </div>` : ''}
                                </div>
                            `).join('')}
                        </div>` :
                        `<div class="img-placeholder" style="background: ${placeholderColor};">
                            <i class="${icon}" style="font-size: 60px;"></i>
                        </div>`
                    }
                </div>
                
                <div class="listing-details">
                    <div class="listing-price">‡§∞‡•Å ${listing.price.toLocaleString()}</div>
                    <div class="listing-title">${listing.title}</div>
                    
                    <div class="listing-meta">
                        <div class="meta-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${listing.location}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-calendar"></i>
                            <span>${listing.date}</span>
                        </div>
                    </div>
                    
                    <p style="font-size: 14px; color: var(--text-light); margin-bottom: 15px;">
                        ${listing.description}
                    </p>
                    
                    <!-- Commission Info -->
                    <div style="background: #fff8e1; padding: 8px; border-radius: 6px; margin-bottom: 10px; font-size: 12px;">
                        <i class="fas fa-info-circle" style="color: #ff9800;"></i>
                        Seller gets: <strong>‡§∞‡•Å ${sellerGets.toLocaleString()}</strong> 
                        (${ADMIN_COMMISSION_RATE}% commission)
                    </div>
                    
                    <!-- Seller Contact Box -->
                    <div class="seller-info">
                        <div class="seller-avatar">
                            ${listing.sellerName.charAt(0)}
                        </div>
                        <div class="seller-details">
                            <div class="seller-name">${listing.sellerName}</div>
                            <div class="seller-phone">
                                <i class="fas fa-phone"></i> ${listing.sellerPhone}
                            </div>
                        </div>
                    </div>
                    
                    ${isOwner ? 
                        `
                        <div class="owner-actions">
                            <button class="owner-btn btn-edit" onclick="editListing(${listing.id})">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="owner-btn btn-delete" onclick="openDeleteModal(${listing.id}, '${listing.title}')">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                        ` : 
                        `
                        <div class="action-buttons">
                                                    <button class="btn btn-secondary" onclick="callSeller('${listing.sellerPhone}')">
                                <i class="fas fa-phone"></i> Call Now
                            </button>
                            <button class="btn btn-primary btn-whatsapp" onclick="sendWhatsApp('${listing.sellerPhone}', '${listing.title}')">
                                <i class="fab fa-whatsapp"></i> WhatsApp Message
                            </button>
                        </div>
                        `
                    }
                    
                    ${isAdmin ? 
                        `
                        <div class="admin-actions">
                            <button class="owner-btn btn-admin" onclick="adminEditListing(${listing.id})">
                                <i class="fas fa-edit"></i> Admin Edit
                            </button>
                            <button class="owner-btn btn-delete" onclick="adminDeleteListing(${listing.id}, '${listing.title}')">
                                <i class="fas fa-trash"></i> Admin Delete
                            </button>
                            <button class="owner-btn btn-block" onclick="openBlockUserModal('${listing.sellerId}', '${listing.sellerName}')">
                                <i class="fas fa-ban"></i> Block Seller
                            </button>
                        </div>
                        ` : ''
                    }
                </div>
            </div>
        `;
    }
    
    function updateStats() {
        document.getElementById('totalPets').textContent = listings.length;
        updateMyListingsCount();
    }
    
    function updateMyListingsCount() {
        if (!currentUser || currentUser.userType !== 'seller') return;
        const myListings = listings.filter(l => l.sellerId === currentUser.id);
        document.getElementById('myListingsCount').textContent = myListings.length;
    }
    
    // ==================== CONTACT FUNCTIONS ====================
    function sendWhatsApp(phone, title) {
        if (!currentUser) {
            alert("Please login to contact sellers");
            toggleAuthModal();
            return;
        }
        
        const message = `Namaste! I'm interested in your "${title}" listing on ABI Fish & Pets. Is it still available?`;
        const encodedMessage = encodeURIComponent(message);
        const whatsappUrl = `https://wa.me/${phone}?text=${encodedMessage}`;
        
        window.open(whatsappUrl, '_blank');
        showNotification(`Opening WhatsApp for ${phone}...`, 'info');
    }
    
    function callSeller(phone) {
        if (!currentUser) {
            alert("Please login to contact sellers");
            toggleAuthModal();
            return;
        }
        
        if (confirm(`Call ${phone}? This will open your phone's dialer.`)) {
            window.location.href = `tel:${phone}`;
            showNotification(`Dialing ${phone}...`, 'info');
        }
    }
    
    // ==================== EDIT FUNCTIONALITY ====================
    function editListing(listingId) {
        const listing = listings.find(l => l.id === listingId);
        if (!listing) return;
        
        if (!currentUser || listing.sellerId !== currentUser.id) {
            alert("You can only edit your own listings");
            return;
        }
        
        document.getElementById('editListingId').value = listing.id;
        document.getElementById('petTitle').value = listing.title;
        document.getElementById('petCategory').value = listing.category;
        document.getElementById('petPrice').value = listing.price;
        document.getElementById('petDescription').value = listing.description;
        document.getElementById('petLocation').value = listing.location;
        document.getElementById('petPhone').value = listing.sellerPhone;
        
        document.getElementById('sellModalTitle').textContent = "Edit Listing";
        document.getElementById('sellModalSubtitle').textContent = "Update your pet listing";
        document.getElementById('submitListingBtn').innerHTML = '<i class="fas fa-save"></i> Update Listing';
        
        uploadedImages = listing.images || [];
        updateImagePreview();
        
        updatePriceDisplay();
        openSellModal();
    }
    
    function adminEditListing(listingId) {
        if (!currentUser || currentUser.userType !== 'admin') {
            alert("Only admin can perform this action");
            return;
        }
        
        const listing = listings.find(l => l.id === listingId);
        if (!listing) return;
        
        document.getElementById('editListingId').value = listing.id;
        document.getElementById('petTitle').value = listing.title;
        document.getElementById('petCategory').value = listing.category;
        document.getElementById('petPrice').value = listing.price;
        document.getElementById('petDescription').value = listing.description;
        document.getElementById('petLocation').value = listing.location;
        document.getElementById('petPhone').value = listing.sellerPhone;
        
        document.getElementById('sellModalTitle').textContent = "Admin: Edit Listing";
        document.getElementById('sellModalSubtitle').textContent = "Edit listing as admin";
        document.getElementById('submitListingBtn').innerHTML = '<i class="fas fa-save"></i> Update as Admin';
        
        uploadedImages = listing.images || [];
        updateImagePreview();
        
        updatePriceDisplay();
        openSellModal();
    }
function adminDeleteListing(listingId, title) {
        if (!currentUser || currentUser.userType !== 'admin') {
            alert("Only admin can perform this action");
            return;
        }
        
        if (confirm(`Admin: Are you sure you want to delete "${title}"?`)) {
            listings = listings.filter(l => l.id !== listingId);
            localStorage.setItem('petListings', JSON.stringify(listings));
            loadListings();
            showNotification("Listing deleted by admin!", 'success');
        }
    }
    
    function updateImagePreview() {
        const preview = document.getElementById('imagePreview');
        preview.innerHTML = '';
        
        uploadedImages.forEach((imgSrc, index) => {
            const imgContainer = document.createElement('div');
            imgContainer.style.position = 'relative';
            imgContainer.style.display = 'inline-block';
            imgContainer.style.margin = '5px';
            
            const img = document.createElement('img');
            img.src = imgSrc;
            img.style.width = '80px';
            img.style.height = '80px';
            img.style.objectFit = 'cover';
            img.style.borderRadius = '8px';
            img.style.border = '2px solid var(--border)';
            
            const removeBtn = document.createElement('button');
            removeBtn.innerHTML = '<i class="fas fa-times"></i>';
            removeBtn.style.cssText = `
                position: absolute;
                top: -5px;
                right: -5px;
                background: var(--danger);
                color: white;
                border: none;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                font-size: 10px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
            `;
            removeBtn.onclick = function(e) {
                e.stopPropagation();
                uploadedImages.splice(index, 1);
                updateImagePreview();
            };
            
            imgContainer.appendChild(img);
            imgContainer.appendChild(removeBtn);
            preview.appendChild(imgContainer);
        });
    }
    
    // ==================== DELETE FUNCTIONALITY ====================
    function openDeleteModal(listingId, listingTitle) {
        listingToDelete = listingId;
        
        const listing = listings.find(l => l.id === listingId);
        
        if (!currentUser || !listing || listing.sellerId !== currentUser.id) {
            alert("You can only delete your own listings");
            return;
        }
        
        document.getElementById('deleteMessage').textContent = 
            `Are you sure you want to delete "${listingTitle}"? This action cannot be undone.`;
        
        document.getElementById('deleteModal').style.display = 'flex';
    }
    
    function closeDeleteModal() {
        document.getElementById('deleteModal').style.display = 'none';
        listingToDelete = null;
    }
    
    function confirmDelete() {
        if (!listingToDelete) return;
        
        const listing = listings.find(l => l.id === listingToDelete);
        
        if (!currentUser || !listing || listing.sellerId !== currentUser.id) {
            alert("You can only delete your own listings");
            return;
        }
        
        const initialLength = listings.length;
        listings = listings.filter(l => l.id !== listingToDelete);
        
        if (listings.length < initialLength) {
            localStorage.setItem('petListings', JSON.stringify(listings));
            loadListings();
            showNotification("Listing deleted successfully!", 'success');
        }
        
        closeDeleteModal();
    }
    
    // ==================== BLOCK USER FUNCTIONALITY ====================
    function openBlockUserModal(userId, userName) {
        if (!currentUser || currentUser.userType !== 'admin') {
            alert("Only admin can block users");
            return;
        }
        
        userToBlock = userId;
        document.getElementById('blockMessage').textContent = 
            `Are you sure you want to block user "${userName}"? They will not be able to login.`;
        
        document.getElementById('blockModal').style.display = 'flex';
    }
    
    function closeBlockModal() {
        document.getElementById('blockModal').style.display = 'none';
        userToBlock = null;
    }
    
    function confirmBlock() {
        if (!userToBlock) return;
        
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const userIndex = users.findIndex(u => u.id === userToBlock);
        
        if (userIndex !== -1) {
            users[userIndex].isActive = false;
            localStorage.setItem('users', JSON.stringify(users));
            
            // Also delete all listings by this user
            const initialCount = listings.length;
            listings = listings.filter(l => l.sellerId !== userToBlock);
            localStorage.setItem('petListings', JSON.stringify(listings));
            
            showNotification(`User blocked and ${initialCount - listings.length} listings removed!`, 'success');
            loadListings();
        }
        
        closeBlockModal();
    }
    
    // ==================== SELL/EDIT FUNCTION ====================
    function openSellModal() {
        if (!currentUser) {
            alert("Please login to sell pets");
            toggleAuthModal();
            return;
        }
        
        // Check if user is blocked
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const user = users.find(u => u.id === currentUser.id);
        
        if (user && !user.isActive) {
            alert("Your account has been blocked. Please contact admin.");
            return;
        }
        
        document.getElementById('sellModal').style.display = 'flex';
        updatePriceDisplay();
    }
    
    function closeSellModal() {
        document.getElementById('sellModal').style.display = 'none';
        resetSellForm();
    }
    
    function resetSellForm() {
        document.getElementById('editListingId').value = '';
        document.getElementById('petTitle').value = '';
        document.getElementById('petCategory').value = '';
        document.getElementById('petPrice').value = '';
        document.getElementById('petDescription').value = '';
        document.getElementById('petLocation').value = '';
        document.getElementById('petPhone').value = '';
        uploadedImages = [];
        document.getElementById('imagePreview').innerHTML = '';
        
        document.getElementById('sellModalTitle').textContent = "Sell Your Pet";
        document.getElementById('sellModalSubtitle').textContent = "List your pet in just 2 minutes";
        document.getElementById('submitListingBtn').innerHTML = '<i class="fas fa-paper-plane"></i> Publish Listing';
    }
    
    function updatePriceDisplay() {
        const price = parseFloat(document.getElementById('petPrice').value) || 0;
        const commission = price * (ADMIN_COMMISSION_RATE/100);
        const sellerGets = price - commission;
        
        const commissionInfo = document.getElementById('commissionInfo');
        if (price > 0) {
            commissionInfo.innerHTML = `
                <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; border-left: 3px solid #ff9800;">
                    <i class="fas fa-info-circle" style="color: #ff9800;"></i>
                    <strong>Commission Details:</strong><br>
                    ‚Ä¢ Listing Price: <strong>‡§∞‡•Å ${price.toLocaleString()}</strong><br>
                    ‚Ä¢ Admin Commission (${ADMIN_COMMISSION_RATE}%): <strong>‡§∞‡•Å ${commission.toFixed(2)}</strong><br>
                    ‚Ä¢ <strong style="color: var(--primary);">You Receive: ‡§∞‡•Å ${sellerGets.toLocaleString()}</strong>
                </div>
            `;
        } else {
            commissionInfo.innerHTML = `
                <div style="color: var(--text-light); font-size: 12px;">
                    <i class="fas fa-info-circle"></i> Enter price to see commission details
                </div>
            `;
        }
    }
    
    function handleImageUpload(event) {
        const files = event.target.files;
        
        for (let i = 0; i < Math.min(files.length, 5 - uploadedImages.length); i++) {
            const file = files[i];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                uploadedImages.push(e.target.result);
                updateImagePreview();
            }
            
            reader.readAsDataURL(file);
        }
        
        event.target.value = '';
    }
    
    // ==================== SUBMIT LISTING ====================
    function submitListing() {
        if (!currentUser) {
            alert("Please login first");
            return;
        }
        
        const title = document.getElementById('petTitle').value;
        const category = document.getElementById('petCategory').value;
        const price = document.getElementById('petPrice').value;
        const description = document.getElementById('petDescription').value;
        const location = document.getElementById('petLocation').value;
        const phone = document.getElementById('petPhone').value;
        const editId = document.getElementById('editListingId').value;
        
        if (!title || !category || !price || !description || !location || !phone) {
            alert("Please fill all required fields");
            return;
        }
        
        if (!phone.match(/^(97|98)\d{8}$/)) {
            alert("Please enter a valid 10-digit Nepali phone number starting with 97 or 98");
            return;
        }
        
        if (parseInt(price) <= 0) {
            alert("Please enter a valid price");
            return;
        }
        
        const listingPrice = parseInt(price);
        const commission = listingPrice * (ADMIN_COMMISSION_RATE/100);
        const sellerGets = listingPrice - commission;
        
        if (editId) {
            // UPDATE EXISTING LISTING
            const index = listings.findIndex(l => l.id == editId);
            if (index !== -1) {
                // Check if admin or owner
                if (currentUser.userType !== 'admin' && listings[index].sellerId !== currentUser.id) {
                    alert("You can only edit your own listings");
                    return;
                }
                
                listings[index] = {
                    ...listings[index],
                    title: title,
                    category: category,
                    price: listingPrice,
                    description: description,
                    location: location,
                    sellerPhone: phone,
                    images: uploadedImages,
                    commission: commission,
                    sellerGets: sellerGets,
                    updatedAt: new Date().toISOString()
                };
                
                showNotification("Listing updated successfully!", 'success');
            }
        } else {
            // CREATE NEW LISTING
            const newListing = {
                id: Date.now(),
                title: title,
                price: listingPrice,
                category: category,
                description: description,
                location: location,
                sellerName: currentUser.name,
                sellerId: currentUser.id,
                sellerPhone: phone,
                date: new Date().toISOString().split('T')[0],
                images: uploadedImages,
                commission: commission,
                sellerGets: sellerGets,
                createdAt: new Date().toISOString(),
                isActive: true
            };
            
            listings.unshift(newListing);
            saveCommissionRecord(newListing);
            
            showNotification(
                `Listing published!<br>
                Price: ‡§∞‡•Å ${listingPrice.toLocaleString()}<br>
                Commission (${ADMIN_COMMISSION_RATE}%): ‡§∞‡•Å ${commission.toFixed(2)}<br>
                You get: ‡§∞‡•Å ${sellerGets.toLocaleString()}`, 
                'success'
            );
        }
        
        localStorage.setItem('petListings', JSON.stringify(listings));
        loadListings();
        closeSellModal();
    }
    
    function saveCommissionRecord(listing) {
        const commissions = JSON.parse(localStorage.getItem('adminCommissions')) || [];
        
        const commissionRecord = {
            id: 'comm_' + Date.now(),
            listingId: listing.id,
            listingTitle: listing.title,
            sellerName: listing.sellerName,
            sellerPhone: listing.sellerPhone,
            amount: listing.price,
            commission: listing.commission,
            commissionRate: ADMIN_COMMISSION_RATE + '%',
            date: new Date().toISOString(),
            status: 'pending'
        };
        
        commissions.unshift(commissionRecord);
        localStorage.setItem('adminCommissions', JSON.stringify(commissions));
    }
    
    // ==================== ADMIN PANEL ====================
    function openAdminPanel() {
        if (!currentUser || currentUser.userType !== 'admin') {
            alert("Only admin can access this panel");
            return;
        }
        
        loadAdminData();
        document.getElementById('adminModal').style.display = 'flex';
    }
    
    function closeAdminPanel() {
        document.getElementById('adminModal').style.display = 'none';
    }
    
    function loadAdminData() {
        // Load users
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const usersList = document.getElementById('adminUsersList');
        usersList.innerHTML = '';
        
        if (users.length === 0) {
            usersList.innerHTML = '<p style="color: var(--text-light); text-align: center;">No users found</p>';
        } else {
            users.forEach(user => {
                const userDiv = document.createElement('div');
                userDiv.style.cssText = `
                        padding: 10px;
                    border-bottom: 1px solid #eee;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                `;
                
                userDiv.innerHTML = `
                    <div>
                        <strong>${user.name}</strong><br>
                        <small>${user.email} | ${user.phone}</small><br>
                        <small>Type: ${user.userType} | Status: ${user.isActive ? 'Active' : 'Blocked'}</small>
                    </div>
                    <div>
                        ${user.userType !== 'admin' ? 
                            `<button onclick="toggleUserStatus('${user.id}', ${!user.isActive})" 
                             style="padding: 5px 10px; border: none; border-radius: 5px; background: ${user.isActive ? '#ff9800' : '#4caf50'}; color: white; cursor: pointer;">
                                ${user.isActive ? 'Block' : 'Unblock'}
                            </button>` : ''
                        }
                    </div>
                `;
                
                usersList.appendChild(userDiv);
            });
        }
        
        // Load listings
        const listingsList = document.getElementById('adminListingsList');
        listingsList.innerHTML = '';
        
        if (listings.length === 0) {
            listingsList.innerHTML = '<p style="color: var(--text-light); text-align: center;">No listings found</p>';
        } else {
            listings.forEach(listing => {
                const listingDiv = document.createElement('div');
                listingDiv.style.cssText = `
                    padding: 10px;
                    border-bottom: 1px solid #eee;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                `;
                
                listingDiv.innerHTML = `
                    <div>
                        <strong>${listing.title}</strong><br>
                        <small>‡§∞‡•Å ${listing.price.toLocaleString()} | ${listing.category} | ${listing.location}</small><br>
                        <small>Seller: ${listing.sellerName} | Date: ${listing.date}</small>
                    </div>
                    <div>
                        <button onclick="adminDeleteListing(${listing.id}, '${listing.title}')" 
                         style="padding: 5px 10px; border: none; border-radius: 5px; background: #f44336; color: white; cursor: pointer;">
                            Delete
                        </button>
                    </div>
                `;
                
                listingsList.appendChild(listingDiv);
            });
        }
    }
    
    function toggleUserStatus(userId, newStatus) {
        if (!currentUser || currentUser.userType !== 'admin') {
            alert("Only admin can perform this action");
            return;
        }
        
        const users = JSON.parse(localStorage.getItem('users')) || [];
        const userIndex = users.findIndex(u => u.id === userId);
        
        if (userIndex !== -1) {
            users[userIndex].isActive = newStatus;
            localStorage.setItem('users', JSON.stringify(users));
            
            if (!newStatus) {
                // Block user - also remove their listings
                const initialCount = listings.length;
                listings = listings.filter(l => l.sellerId !== userId);
                localStorage.setItem('petListings', JSON.stringify(listings));
                
                showNotification(`User ${newStatus ? 'unblocked' : 'blocked'} and ${initialCount - listings.length} listings removed!`, 'success');
            } else {
                showNotification(`User ${newStatus ? 'unblocked' : 'blocked'}!`, 'success');
            }
            
            loadAdminData();
            loadListings();
        }
    }
    
    // ==================== FILTER FUNCTIONS ====================
    function filterByCategory(category) {
        document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        
        const container = document.getElementById('listingsContainer');
        container.innerHTML = '';
        
        const filtered = category === 'all' 
            ? listings 
            : listings.filter(listing => listing.category === category);
        
        if (filtered.length === 0) {
            container.innerHTML = `
                <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: var(--text-light);">
                    <i class="fas fa-paw" style="font-size: 50px; margin-bottom: 20px;"></i>
                    <h3>No Pets in This Category</h3>
                    <p>Check back soon or try another category</p>
                    <button class="btn btn-primary" onclick="loadListings()" style="margin-top: 10px;">
                        <i class="fas fa-redo"></i> Reset Filters
                    </button>
                </div>
            `;
            return;
        }
        
        filtered.forEach(listing => {
            const card = createListingCard(listing);
            container.innerHTML += card;
        });
    }
    
    // ==================== UTILITY FUNCTIONS ====================
    function getCategoryIcon(category) {
        const icons = {
            'dog': 'fas fa-dog',
            'cat': 'fas fa-cat',
            'fish': 'fas fa-fish',
            'bird': 'fas fa-dove',
              'other': 'fas fa-paw'
        };
        return icons[category] || 'fas fa-paw';
    }
    
    function getCategoryColor(category) {
        const colors = {
            'dog': 'linear-gradient(45deg, #ffcc80, #ffb74d)',
            'cat': 'linear-gradient(45deg, #b39ddb, #9575cd)',
            'fish': 'linear-gradient(45deg, #80deea, #4fc3f7)',
            'bird': 'linear-gradient(45deg, #a5d6a7, #81c784)',
            'other': 'linear-gradient(45deg, #ffab91, #ff8a65)'
        };
        return colors[category] || 'linear-gradient(45deg, #e0e0e0, #bdbdbd)';
    }
    
    function getCategoryName(category) {
        const names = {
            'dog': 'Dog',
            'cat': 'Cat',
            'fish': 'Fish',
            'bird': 'Bird',
            'other': 'Other'
        };
        return names[category] || 'Pet';
    }
    
    function showNotification(message, type) {
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: ${type === 'success' ? '#4caf50' : type === 'info' ? '#2196f3' : '#ff9800'};
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 3000;
            animation: slideInRight 0.3s ease;
            font-weight: 500;
            max-width: 400px;
        `;
        notification.innerHTML = `
            <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'info' ? 'info-circle' : 'exclamation-triangle'}"></i>
            ${message}
        `;
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.style.animation = 'slideOutRight 0.3s ease';
            setTimeout(() => notification.remove(), 300);
        }, 3000);
        
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    }
</script>
</body>
</html>
