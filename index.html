<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABI fish & pets - Nepal's</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2e7d32;
            --primary-dark: #1b5e20;
            --primary-light: #4caf50;
            --secondary: #ff9800;
            --secondary-dark: #ef6c00;
            --accent: #2196f3;
            --danger: #f44336;
            --danger-dark: #d32f2f;
            --text: #333;
            --text-light: #666;
            --bg: #f8fdf8;
            --card: #ffffff;
            --shadow: rgba(0, 0, 0, 0.08);
            --border: #e0f2e1;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Poppins', sans-serif;
        }
        
        body {
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        /* Header with Custom Logo */
        .header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(46, 125, 50, 0.2);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-circle {
            width: 45px;
            height: 45px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .logo-circle i {
            font-size: 22px;
            color: var(--primary);
        }
        
        .logo-circle img{
            width:30px;
            height:30px;
            object-fit:contain;
        }
        
        .logo-text {
            font-size: 22px;
            font-weight: 800;
            letter-spacing: 0.5px;
        }
        
        .logo-tagline {
            font-size: 11px;
            opacity: 0.9;
            margin-top: -2px;
            font-weight: 300;
        }
        
        .user-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-profile {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid rgba(255,255,255,0.3);
        }
        
        .user-profile:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
        
        /* My Listings Button */
        .my-listings-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center ;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .my-listings-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* Admin Control Button */
        .admin-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center ;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .admin-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        /* Auth Modal - Modern Design */
        .auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        
        .auth-content {
            background: var(--card);
            width: 90%;
            max-width: 420px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            animation: slideUp 0.4s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .auth-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 25px;
            text-align: center;
            color: white;
        }
        
        .auth-header h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .auth-tabs {
            display: flex;
            background: #f5f5f5;
        }
        
        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 18px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            color: var(--text-light);
        }
        
        .auth-tab.active {
            background: white;
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        .auth-body {
            padding: 30px;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
            font-size: 14px;
        }
        
        .input-with-icon {
            position: relative;
        }
        
        .input-with-icon i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
        }
        
        .auth-input {
            width: 100%;
            padding: 14px 14px 14px 45px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
            background: #fcfcfc;
        }
        
        .auth-input:focus {
            outline: none;
            border-color: var(--primary);
            background: white;
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }
        
        /* Main Content */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .hero {
    height: 70vh; /* Tapai le pahile nai halnu bhayeko chha */
    background-image: url("paladrium.jpg"); /* Sahi path halnu-hos */
    background-size: cover; /* Yasle image lai section bhitra thikka parera adaptive banaucha */
    background-position: center; /* Image ko bhibhag center ma dekhaucha */
    background-repeat: no-repeat; /* Image pheri-pheri dohorina didaina */
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    color:white;
}

/* Overlay to make text readable */
.hero-overlay{
  position: absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:black(0,0,0,0.45) /* semi-transparent dark overlay */
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 20px;
}

.hero-content{
  max-width: 700px;
}

.hero h1{
  font-size: 42px;
  margin-bottom: 15px;
}

.hero p{
  font-size: 16px;
  opacity: .95;
  margin-bottom: 25px;
}
 /* Search and Filter */
        .search-section {
            background: var(--card);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px var(--shadow);
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }
        
        .search-box i {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary);
        }
        
        .search-box input {
            width: 100%;
            padding: 16px 20px 16px 50px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }
        
        /* Category Filters */
        .category-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .category-btn {
            padding: 12px 24px;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .category-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }
        
        .category-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Listing Cards - Enhanced Design */
        .listings {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .listing-card {
            background: var(--card);
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 8px 25px var(--shadow);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
            border: 1px solid var(--border);
            position: relative;
        }
        
        .listing-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(46, 125, 50, 0.15);
        }
        
        .listing-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--secondary);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            z-index: 2;
        }
        
        .listing-img {
            height: 200px;
            position: relative;
            overflow: hidden;
        }
        
        .listing-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s;
        }
        
        .listing-card:hover .listing-img img {
            transform: scale(1.05);
        }
        
        .img-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #e8f5e9, #c8e6c9);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }
        
        .listing-details {
            padding: 20px;
        }
        
        .listing-price {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .listing-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text);
        }
        
        .listing-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 13px;
            color: var(--text-light);
        }
        
        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .seller-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .seller-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }
        
        .seller-details {
            flex: 1;
        }
        
        .seller-name {
            font-weight: 600;
            font-size: 14px;
        }
        
        .seller-phone {
            font-size: 12px;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex: 1;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: #f0f7ff;
            color: var(--accent);
            border: 2px solid #e3f2fd;
        }
        
        .btn-secondary:hover {
            background: #e3f2fd;
        }
        
        .btn-edit {
            background: #fff3e0;
            color: var(--secondary);
            border: 2px solid #ffe0b2;
        }
        
        .btn-edit:hover {
            background: #ffe0b2;
        }
        
        .btn-delete {
            background: #ffebee;
            color: var(--danger);
            border: 2px solid #ffcdd2;
        }
        
        .btn-delete:hover {
            background: #ffcdd2;
        }
        
        .btn-block {
            background: #ffebee;
            color: var(--danger);
            border: 2px solid #ffcdd2;
        }
        
        .btn-block:hover {
            background: #ffcdd2;
        }
        
        .btn-admin {
            background: #673ab7;
            color: white;
            border: 2px solid #5e35b1;
        }
        
        .btn-admin:hover {
            background: #5e35b1;
        }
        
        /* Owner Actions */
        .owner-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }
        
        .owner-btn {
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 13px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            flex: 1;
        }
        
        /* Admin Actions */
        .admin-actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            border-top: 1px dashed #ddd;
            padding-top: 10px;
        }
        
        /* Sell Button - Attractive Design */
        .sell-btn-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 999;
        }
        
        .sell-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--secondary), var(--secondary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4);
            transition: all 0.3s;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4); }
            50% { box-shadow: 0 8px 30px rgba(255, 152, 0, 0.6); }
            100% { box-shadow: 0 8px 25px rgba(255, 152, 0, 0.4); }
        }
        
        .sell-btn:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        /* Sell Modal - Attractive Design */
        .sell-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        
        .sell-content {
            background: var(--card);
            width: 90%;
            max-width: 500px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            animation: slideUp 0.4s ease;
        }
        
        .sell-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 25px;
            text-align: center;
            color: white;
            position: relative;
        }
        
        .sell-header h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .sell-header i {
            position: absolute;
      right: 25px;
            top: 25px;
            font-size: 20px;
            cursor: pointer;
            opacity: 0.8;
        }
        
        .sell-header i:hover {
            opacity: 1;
        }
        
        .sell-body {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
        }
        
        .form-control {
            width: 100%;
            padding: 14px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }
        
        /* Image Upload */
        .image-upload-area {
            border: 2px dashed var(--primary);
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #f8fff8;
        }
        
        .image-upload-area:hover {
            background: #f0fff0;
            border-color: var(--primary-dark);
        }
        
        .upload-icon {
            font-size: 40px;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
              /* Delete Confirmation Modal */
        .confirm-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            z-index: 2100;
        }
        
        .confirm-content {
            background: var(--card);
            width: 90%;
            max-width: 400px;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .confirm-icon {
            font-size: 50px;
            color: var(--danger);
            margin-bottom: 20px;
        }
        
        /* Stats Bar */
        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: var(--card);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px var(--shadow);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-number {
            font-size: 28px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 13px;
            color: var(--text-light);
        }
        
        /* Footer */
        .footer {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: white;
            padding: 40px 20px;
            text-align: center;
            margin-top: 50px;
        }
        
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .listings {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .search-section {
                flex-direction: column;
            }
            
            .search-box {
                min-width: 100%;
            }
            
            .hero-title {
                font-size: 24px;
            }
        }
        
        /* WhatsApp Button Color */
        .btn-whatsapp {
            background: #25D366 !important;
            color: white !important;
            border: none !important;
        }
        
        .btn-whatsapp:hover {
            background: #128C7E !important;
            transform: translateY(-2px);
        }
        
        /* WhatsApp Icon */
        .fa-whatsapp {
            font-size: 16px;
        }
        
        /* Images Grid Layout */
        .images-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2px;
            height: 200px;
            overflow: hidden;
        }
        
        /* Login/Register Link */
        .auth-switch-link {
            text-align: center;
            margin-top: 20px;
            color: var(--text-light);
            font-size: 14px;
        }
        
        .auth-switch-link a {
            color: var(--primary);
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
        }
        
        .auth-switch-link a:hover {
            text-decoration: underline;
        }
        
        /* User Menu Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* User Type Selection */
        .user-type-selection {
            display: flex;
            gap: 10px;
            margin-top: 8px;
        }
        
        .user-type-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            background: #f8f9fa;
            text-align: center;
            transition: all 0.3s;
        }
        
        .user-type-btn:hover {
            border-color: var(--primary);
        }
        
        .user-type-btn.selected {
            border-color: var(--primary) !important;
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9) !important;
            color: var(--primary) !important;
        }
        
        .user-type-btn i {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        .user-type-btn strong {
            display: block;
            margin-bottom: 5px;
        }
        
        .user-type-btn small {
            font-size: 11px;
            color: #666;
        }
        
        /* Back Button */
        .back-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 0 auto;
        }
        
        .back-btn:hover {
            background: #5a6268;
        }
    </style>
</head>
<body>
      <!-- Header -->
    <div class="header">
        <div class="logo-container">
            <div class="logo-circle">
                <img src="logo1.png" alt="Logo" style="width: 45px; height: 45px;">
            </div>
            <div>
                <div class="logo-text">ABI Fish & Pets</div>
                <div class="logo-tagline">Nepal's Trusted Pet Marketplace</div>
            </div>
        </div>
        
        <div class="user-section">
            <button class="admin-btn" onclick="openAdminPanel()" id="adminBtn" style="display: none;">
                <i class="fas fa-cog"></i> Admin Panel
            </button>
            <button class="my-listings-btn" onclick="showMyListings()" id="myListingsBtn" style="display: none;">
                <i class="fas fa-list"></i> My Listings
            </button>
            <div class="user-profile" onclick="toggleAuthModal()" id="userInitial">
                <i class="fas fa-user"></i>
            </div>
        </div>
    </div>    
    
    <!-- Auth Modal -->
    <div class="auth-modal" id="authModal">
        <div class="auth-content">
            <div class="auth-header">
                <h2>Welcome Back!</h2>
                <p>Sign in to buy or sell pets</p>
            </div>
            
            <div class="auth-tabs">
                <div class="auth-tab active" onclick="switchAuthTab('login')">Login</div>
                <div class="auth-tab" onclick="switchAuthTab('register')">Register</div>
            </div>
            
            <div class="auth-body">
                <div id="loginForm">
                    <div class="input-group">
                        <label>Email Address</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" class="auth-input" id="loginEmail" placeholder="you@example.com">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Password</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" class="auth-input" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        </div>
                    </div>
                    user? <a href="javascript:void(0)" onclick="switchAuthTab('register')">Create an account</a>
                    </div>
                    
                    <!-- Admin Login Hint -->
                    <div style="margin-top: 20px; padding: 10px; background: #fff3e0; border-radius: 8px; border-left: 4px solid #ff9800;">
                    </div>
                </div>            
                
                <div id="registerForm" style="display: none;">
                    <div class="input-group">
                        <label>Full Name</label>
                        <div class="input-with-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" class="auth-input" id="regName" placeholder="John Doe">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Email Address</label>
                        <div class="input-with-icon">
                            <i class="fas fa-envelope"></i>
                            <input type="email" class="auth-input" id="regEmail" placeholder="you@example.com">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Phone Number</label>
                        <div class="input-with-icon">
                            <i class="fas fa-phone"></i>
                            <input type="tel" class="auth-input" id="regPhone" placeholder="97XXXXXXXX or 98XXXXXXXX">
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label>Account Type *</label>
                        <div class="user-type-selection">
                            <button type="button" class="user-type-btn" onclick="selectUserType('customer')">
                                <i class="fas fa-user"></i><br>
                                <strong>Customer</strong><br>
                                <small>Only buy pets</small>
                            </button>
                            <button type="button" class="user-type-btn" onclick="selectUserType('seller')">
                                <i class="fas fa-store"></i><br>
                                <strong>Seller</strong><br>
                                <small>Sell & buy pets</small>
                            </button>
                        </div>
                        <input type="hidden" id="userType" value="customer">
                    </div>
                    
                    <div class="input-group">
                        <label>Password</label>
                        <div class="input-with-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" class="auth-input" id="regPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" style="width: 100%; margin-top: 10px;" onclick="register()">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                    
                    <div class="auth-switch-link">
                        Already have an account? <a href="javascript:void(0)" onclick="switchAuthTab('login')">Sign in</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Delete Confirmation Modal -->
    <div class="confirm-modal" id="deleteModal">
        <div class="confirm-content">
            <div class="confirm-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 style="margin-bottom: 10px; color: var(--danger);">Delete Listing</h3>
            <p id="deleteMessage" style="margin-bottom: 25px; color: var(--text-light);">
                Are you sure you want to delete this listing?
            </p>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn btn-secondary" onclick="closeDeleteModal()" style="min-width: 100px;">
                    Cancel
                </button>
                <button class="btn" onclick="confirmDelete()" 
                        style="background: var(--danger); color: white; min-width: 100px;">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        </div>
    </div>
    
    <!-- Block Confirmation Modal -->
    <div class="confirm-modal" id="blockModal">
        <div class="confirm-content">
            <div class="confirm-icon">
                <i class="fas fa-ban" style="color: #ff9800;"></i>
            </div>
            <h3 style="margin-bottom: 10px; color: #ff9800;">Block User</h3>
            <p id="blockMessage" style="margin-bottom: 25px; color: var(--text-light);">
                Are you sure you want to block this user?
            </p>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn btn-secondary" onclick="closeBlockModal()" style="min-width: 100px;">
                    Cancel
                </button>
                <button class="btn" onclick="confirmBlock()" 
                        style="background: #ff9800; color: white; min-width: 100px;">
                    <i class="fas fa-ban"></i> Block
                </button>
            </div>
        </div>
    </div>
    
    <section class="hero">
  <div class="hero-overlay">
    <div class="hero-content">
      <h1>Find Your Perfect Pet Companion</h1>
      <p>
        Buy, sell, or adopt pets in Nepal's largest pet marketplace.
        Connect with trusted sellers and find your furry, feathery, or scaly friend today!
      </p>
      <button class="btn btn-primary" onclick="filterByCategory('fish')">
        Explore Pets
      </button>
    </div>
  </div>
</section> 
        
        <!-- Stats Bar -->
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-number" id="totalPets">0</div>
                <div class="stat-label">Pets Available</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="myListingsCount">0</div>
                <div class="stat-label">My Listings</div>
            </div>
            <div class="stat-item">
                <div class="stat-number">2.5%</div>
                <div class="stat-label">Admin Commission</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="cities">15+</div>
                <div class="stat-label">Cities Across Nepal</div>
            </div>
        </div>
        
        <!-- Search Section -->
        <div class="search-section">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Search for pets, breeds, or sellers...">
            </div>
            
            <select class="form-control" style="min-width: 180px;" id="locationFilter">
                <option value="">All Locations</option>
                <option value="kathmandu">Kathmandu</option>
                <option value="pokhara">Pokhara</option>
                <option value="biratnagar">Biratnagar</option>
                <option value="butwal">Butwal</option>
                <option value="chitwan">Chitwan</option>
            </select>
            
            <select class="form-control" style="min-width: 150px;" id="priceFilter">
                <option value="">Any Price</option>
                <option value="low">Under ‡§∞‡•Å 5,000</option>
                <option value="medium">‡§∞‡•Å 5,000 - 20,000</option>
                <option value="high">Over ‡§∞‡•Å 20,000</option>
            </select>
        </div>
        
        <!-- Category Filters -->
        <div class="category-filters">
            <div class="category-btn active" onclick="filterByCategory('all')">
                <i class="fas fa-paw"></i> All Pets
            </div>
            <div class="category-btn" onclick="filterByCategory('dog')">
                <i class="fas fa-dog"></i> Dogs
            </div>
            <div class="category-btn" onclick="filterByCategory('cat')">
                <i class="fas fa-cat"></i> Cats
            </div>
            <div class="category-btn" onclick="filterByCategory('fish')">
                <i class="fas fa-fish"></i> Fish
            </div>
            <div class="category-btn" onclick="filterByCategory('bird')">
                <i class="fas fa-dove"></i> Birds
            </div>
            <div class="category-btn" onclick="filterByCategory('other')">
                <i class="fas fa-dragon"></i> Others
            </div>
        </div>
        
        <!-- Listings Grid -->
        <div class="listings" id="listingsContainer">
            <!-- Listings loaded by JavaScript -->
        </div>
    </div>
    
    <!-- Sell Button -->
    <div class="sell-btn-container">
        <div class="sell-btn" onclick="openSellModal()">
            <i class="fas fa-plus"></i>
        </div>
    </div>
    
    <!-- Sell Modal -->
    <div class="sell-modal" id="sellModal">
        <div class="sell-content">
            <div class="sell-header">
                <h2 id="sellModalTitle">Sell Your Pet</h2>
                <p id="sellModalSubtitle">List your pet in just 2 minutes</p>
                <i class="fas fa-times" onclick="closeSellModal()"></i>
            </div>
            
            <div class="sell-body">
                <input type="hidden" id="editListingId" value="">
                
                <div class="form-group">
                    <label class="form-label">Pet Name/Title *</label>
                    <input type="text" class="form-control" id="petTitle" placeholder="e.g., Golden Retriever Puppy">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Category *</label>
                    <select class="form-control" id="petCategory">
                        <option value="">Select Category</option>
                        <option value="dog">Dog</option>
                        <option value="cat">Cat</option>
                        <option value="fish">Fish</option>
                        <option value="bird">Bird</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Price (NPR) *</label>
                    <input type="number" class="form-control" id="petPrice" placeholder="e.g., 15000">
                    <div id="commissionInfo" style="margin-top: 8px; font-size: 13px; color: var(--text-light);"></div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Description *</label>
                    <textarea class="form-control" id="petDescription" rows="3" placeholder="Describe your pet"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Location *</label>
                    <input type="text" class="form-control" id="petLocation" placeholder="e.g., Kathmandu">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Contact Phone *</label>
                    <input type="tel" class="form-control" id="petPhone" placeholder="97XXXXXXXX or 98XXXXXXXX">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Pet Images (Optional)</label>
                    <div class="image-upload-area" onclick="document.getElementById('imageUpload').click()">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div style="font-weight: 600; color: var(--primary);">Click to Upload Images</div>
                        <div style="font-size: 13px; color: var(--text-light);">Upload clear photos (Max 5)</div>
                    </div>
                    <input type="file" id="imageUpload" accept="image/*" multiple style="display: none;" onchange="handleImageUpload(event)">
                    <div id="imagePreview" style="margin-top: 15px; display: flex; flex-wrap: wrap; gap: 10px;"></div>
                </div>
                
                <button class="btn btn-primary" style="width: 100%; padding: 16px; font-size: 16px; margin-top: 20px;" 
                        onclick="submitListing()" id="submitListingBtn">
                    <i class="fas fa-paper-plane"></i> Publish Listing
                </button>
            </div>
        </div>
    </div>
    
    <!-- Admin Panel Modal -->
    <div class="auth-modal" id="adminModal">
        <div class="auth-content">
            <div class="auth-header">
                <h2>Admin Panel</h2>
                <p>Manage users and listings</p>
            </div>
            
            <div class="auth-body">
                <div style="margin-bottom: 20px;">
                    <h3 style="margin-bottom: 15px; color: var(--primary);">All Users</h3>
                    <div id="adminUsersList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 8px; padding: 10px;">
                        <!-- Users will be loaded here -->
                    </div>
                </div>
                
                <div style="margin-bottom: 20px;">
                    <h3 style="margin-bottom: 15px; color: var(--primary);">All Listings</h3>
                    <div id="adminListingsList" style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 8px; padding: 10px;">
                        <!-- Listings will be loaded here -->
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="closeAdminPanel()">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="footer-content">
            <div style="font-size: 24px; font-weight: 800; margin-bottom: 20px;">ABI Fish & Pets</div>
            <div style="max-width: 600px; margin: 0 auto 30px; opacity: 0.9;">
                Nepal's most trusted platform for buying and selling pets. Connecting pet lovers since 2021.
            </div>
            <div style="display: flex; justify-content: center; gap: 20px; margin-bottom: 30px;">
                <a href="#" style="color: white; opacity: 0.8; transition: opacity 0.3s;">About Us</a>
                <a href="#" style="color: white; opacity: 0.8; transition: opacity 0.3s;">Contact : 9703710719</a>
                <a href="#" style="color: white; opacity: 0.8; transition: opacity 0.3s;">Privacy Policy</a>
                <a href="#" style="color: white; opacity: 0.8; transition: opacity 0.3s;">Terms of Service</a>
            </div>
            <div style="opacity: 0.7; font-size: 14px;">
                ¬© 2021 ABI Fish & Pets. Thankyou for choosing us.üôèüíê
            </div>
        </div>
    </div>
<!-- Firebase SDKs -->
<script type="module">
  // Import Firebase v12 modules
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";

  // Your Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAgrXYL1M-cO8LYTmJeEtfwhkp-ghXfNWY",
    authDomain: "abi-fish-pets.firebaseapp.com",
    databaseURL: "https://abi-fish-pets-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "abi-fish-pets",
    storageBucket: "abi-fish-pets.firebasestorage.app",
    messagingSenderId: "644115504257",
    appId: "1:644115504257:web:278b713d235aa8938a0180",
    measurementId: "G-2T3T8RTJKE"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);

  // ==================== GLOBAL STATE ====================
  let currentUser = null;
  let uploadedImages = [];
  let listingToDelete = null;
  const ADMIN_COMMISSION_RATE = 2.5;
  // ==================== ORDER + COMMISSION AUTO ====================
async function placeOrder(listingId, title, price, sellerId){
  if(!currentUser){
    alert("Please login to place order");
    toggleAuthModal();
    return;
  }

  const paymentMethod = prompt("Payment method: cash / online");
  if(!paymentMethod) return;

  const commission = price * (ADMIN_COMMISSION_RATE / 100);
  const sellerGets = price - commission;

  try{
    await addDoc(collection(db,"orders"),{
      listingId: listingId,
      listingTitle: title,
      sellerId: sellerId,
      buyerId: currentUser.id,
      price: price,
      commission: commission,
      sellerGets: sellerGets,
      paymentMethod: paymentMethod,
      orderStatus: "pending",
      createdAt: serverTimestamp()
    });

    showNotification(
      `Order placed successfully! Seller gets ‡§∞‡•Å ${sellerGets.toLocaleString()}`,
      "success"
    );
  }catch(error){
    alert("Order failed: " + error.message);
  }
}

  // ==================== INITIALIZATION ====================
  document.addEventListener('DOMContentLoaded', function() {
    setupEventListeners();
    setupAuthStateListener();
    loadListings();
  });

  function setupEventListeners() {
    document.getElementById('petPrice').addEventListener('input', updatePriceDisplay);
    
    // Search functionality
    document.getElementById('searchInput').addEventListener('input', filterListings);
    document.getElementById('locationFilter').addEventListener('change', filterListings);
    document.getElementById('priceFilter').addEventListener('change', filterListings);
  }

  // ==================== AUTHENTICATION ====================
  function setupAuthStateListener() {
    onAuthStateChanged(auth, (user) => {
      if (user) {
        currentUser = {
          id: user.uid,
          name: user.displayName || user.email.split('@')[0],
          email: user.email,
          phone: localStorage.getItem(`userPhone_${user.uid}`) || '',
          userType: localStorage.getItem(`userType_${user.uid}`) || 'customer'
        };
        updateUserUI();
      } else {
        currentUser = null;
        updateUserUI();
      }
    });
  }

  function toggleAuthModal() {
    const modal = document.getElementById('authModal');
    modal.style.display = modal.style.display === 'flex' ? 'none' : 'flex';
  }

  function switchAuthTab(tab) {
    document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
    event.target.classList.add('active');
    
    document.getElementById('loginForm').style.display = tab === 'login' ? 'block' : 'none';
    document.getElementById('registerForm').style.display = tab === 'register' ? 'block' : 'none';
  }

  async function login() {
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    if (!email || !password) {
      alert("Please enter email and password");
      return;
    }
    
    try {
      await signInWithEmailAndPassword(auth, email, password);
      showNotification("Login successful!", 'success');
      toggleAuthModal();
    } catch (error) {
      alert("Login failed: " + error.message);
    }
  }

  async function register() {
    const email = document.getElementById('regEmail').value;
    const password = document.getElementById('regPassword').value;
    const name = document.getElementById('regName').value;
    const phone = document.getElementById('regPhone').value;
    const userType = document.getElementById('userType').value;
    
    if (!email || !password || !name || !phone || !userType) {
      alert("Please fill all fields");
      return;
    }
    
    if (!phone.match(/^(97|98)\d{8}$/)) {
      alert("Please enter a valid Nepali phone number starting with 97 or 98");
      return;
    }
    
    try {
      // Create user
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;
      
      // Save additional user info
      localStorage.setItem(`userType_${user.uid}`, userType);
      localStorage.setItem(`userPhone_${user.uid}`, phone);
      localStorage.setItem(`userName_${user.uid}`, name);
      
      // Update display name
      await updateProfile(user, {
        displayName: name
      });
      
      showNotification("Account created successfully!", 'success');
      toggleAuthModal();
    } catch (error) {
      alert("Registration failed: " + error.message);
    }
  }

  function logout() {
    if (confirm("Are you sure you want to logout?")) {
      signOut(auth).then(() => {
        showNotification("Logged out successfully", 'info');
      });
    }
  }

  function updateUserUI() {
    const userInitial = document.getElementById('userInitial');
    const myListingsBtn = document.getElementById('myListingsBtn');
    
    if (currentUser) {
      userInitial.innerHTML = currentUser.userType === 'seller' ? 
        `<i class="fas fa-store"></i>` : 
        `<i class="fas fa-user"></i>`;
      userInitial.onclick = showUserMenu;
      
      myListingsBtn.style.display = currentUser.userType === 'seller' ? 'flex' : 'none';
      myListingsBtn.onclick = showMyListings;
      
      // Update my listings count
      updateMyListingsCount();
    } else {
      userInitial.innerHTML = `<i class="fas fa-user"></i>`;
      userInitial.onclick = toggleAuthModal;
      myListingsBtn.style.display = 'none';
    }
  }

  // ==================== FIRESTORE DATABASE OPERATIONS ====================
  async function loadListings() {
    const container = document.getElementById('listingsContainer');
    container.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:40px;"><i class="fas fa-spinner fa-spin"></i> Loading listings...</div>';
    
    try {
      const q = query(collection(db, "listings"), orderBy("createdAt", "desc"));
      const querySnapshot = await getDocs(q);
      
      container.innerHTML = '';
      let listingsCount = 0;
      
      querySnapshot.forEach((doc) => {
        const listing = doc.data();
        listing.id = doc.id;
        const card = createListingCard(listing);
        container.innerHTML += card;
        listingsCount++;
      });
      
      document.getElementById('totalPets').textContent = listingsCount;
      
      if (listingsCount === 0) {
        container.innerHTML = `
          <div style="grid-column:1/-1; text-align:center; padding:40px; color:var(--text-light);">
            <i class="fas fa-paw" style="font-size:50px;"></i>
            <h3>No Pets Available Yet</h3>
            <p>Be the first to list a pet!</p>
          </div>
        `;
      }
    } catch (error) {
      console.error("Error loading listings: ", error);
      container.innerHTML = `<div style="grid-column:1/-1; text-align:center; padding:40px; color:red;">Error loading listings. Please refresh.</div>`;
    }
  }

  async function submitListing() {
    if (!currentUser) {
      alert("Please login first");
      toggleAuthModal();
      return;
    }
    
    if (currentUser.userType !== 'seller') {
      alert("Only sellers can list pets");
      return;
    }
    
    const title = document.getElementById('petTitle').value;
    const category = document.getElementById('petCategory').value;
    const price = document.getElementById('petPrice').value;
    const description = document.getElementById('petDescription').value;
    const location = document.getElementById('petLocation').value;
    const phone = document.getElementById('petPhone').value;
    const editId = document.getElementById('editListingId').value;
    
    // Validation
    if (!title || !category || !price || !description || !location || !phone) {
      alert("Please fill all required fields");
      return;
    }
    
    const listingPrice = parseInt(price);
    if (listingPrice <= 0) {
      alert("Please enter a valid price");
      return;
    }
    
    const commission = listingPrice * (ADMIN_COMMISSION_RATE/100);
    const sellerGets = listingPrice - commission;
    
    const listingData = {
      title: title,
      category: category,
      price: listingPrice,
      description: description,
      location: location,
      sellerName: currentUser.name,
      sellerId: currentUser.id,
      sellerPhone: phone,
      images: uploadedImages,
      commission: commission,
      sellerGets: sellerGets,
      createdAt: serverTimestamp(),
      updatedAt: serverTimestamp()
    };
    
    try {
      if (editId) {
        // Update existing listing
        const listingRef = doc(db, "listings", editId);
        await updateDoc(listingRef, listingData);
        showNotification("Listing updated successfully!", 'success');
      } else {
        // Create new listing
        await addDoc(collection(db, "listings"), listingData);
        showNotification(`Listing published! Price: ‡§∞‡•Å ${listingPrice.toLocaleString()}`, 'success');
      }
      loadListings();
      closeSellModal();
    } catch (error) {
      alert("Error: " + error.message);
    }
  }

  async function confirmDelete() {
    if (!listingToDelete) return;
    
    try {
      await deleteDoc(doc(db, "listings", listingToDelete));
      showNotification("Listing deleted successfully!", 'success');
      loadListings();
      closeDeleteModal();
    } catch (error) {
      alert("Error deleting listing: " + error.message);
    }
  }

  async function updateMyListingsCount() {
    if (!currentUser || currentUser.userType !== 'seller') return;
    
    try {
      const q = query(collection(db, "listings"), orderBy("createdAt", "desc"));
      const querySnapshot = await getDocs(q);
      
      let myListingsCount = 0;
      querySnapshot.forEach((doc) => {
        const listing = doc.data();
        if (listing.sellerId === currentUser.id) {
          myListingsCount++;
        }
      });
      
      document.getElementById('myListingsCount').textContent = myListingsCount;
    } catch (error) {
      console.error("Error counting listings: ", error);
    }
  }

  // ==================== UI FUNCTIONS (Keep your existing ones) ====================
  function createListingCard(listing) {
    const icon = getCategoryIcon(listing.category);
    const placeholderColor = getCategoryColor(listing.category);
    const isOwner = currentUser && listing.sellerId === currentUser.id;
    
    // Format date
    let dateDisplay = "Recent";
    if (listing.createdAt && listing.createdAt.toDate) {
      dateDisplay = listing.createdAt.toDate().toLocaleDateString();
    }
    
    return `
      <div class="listing-card" data-category="${listing.category}" data-id="${listing.id}">
        <div class="listing-badge">${getCategoryName(listing.category)}</div>
        
        <!-- Images Display -->
        <div class="listing-img">
          ${listing.images && listing.images.length > 0 ? 
            `<div style="display: grid; grid-template-columns: repeat(${Math.min(listing.images.length, 3)}, 1fr); gap: 2px; height: 100%;">
              ${listing.images.slice(0, 3).map((img, index) => `
                <div style="overflow: hidden; position: relative; ${listing.images.length === 1 ? 'grid-column: 1/-1;' : ''}">
                  <img src="${img}" alt="${listing.title} ${index + 1}" 
                       style="width: 100%; height: 100%; object-fit: cover;">
                  ${listing.images.length > 1 && index === 2 && listing.images.length > 3 ? 
                    `<div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: bold;">
                      +${listing.images.length - 3}
                    </div>` : ''}
                </div>
              `).join('')}
            </div>` :
            `<div class="img-placeholder" style="background: ${placeholderColor};">
              <i class="${icon}" style="font-size: 60px;"></i>
            </div>`
          }
        </div>
        
        <div class="listing-details">
          <div class="listing-price">‡§∞‡•Å ${listing.price.toLocaleString()}</div>
          <div class="listing-title">${listing.title}</div>
          
          <div class="listing-meta">
            <div class="meta-item">
              <i class="fas fa-map-marker-alt"></i>
              <span>${listing.location}</span>
            </div>
            <div class="meta-item">
              <i class="fas fa-calendar"></i>
              <span>${dateDisplay}</span>
            </div>
          </div>
          
          <p style="font-size: 14px; color: var(--text-light); margin-bottom: 15px;">
            ${listing.description}
          </p>
          
          <!-- Commission Info -->
          <div style="background: #fff8e1; padding: 8px; border-radius: 6px; margin-bottom: 10px; font-size: 12px;">
            <i class="fas fa-info-circle" style="color: #ff9800;"></i>
            Seller gets: <strong>‡§∞‡•Å ${listing.sellerGets?.toLocaleString() || (listing.price - (listing.price * (ADMIN_COMMISSION_RATE/100))).toLocaleString()}</strong> 
            (${ADMIN_COMMISSION_RATE}% commission)
          </div>
          
          <!-- Seller Contact Box -->
          <div class="seller-info">
            <div class="seller-avatar">
              ${listing.sellerName?.charAt(0) || 'S'}
            </div>
            <div class="seller-details">
              <div class="seller-name">${listing.sellerName || 'Seller'}</div>
              <div class="seller-phone">
                <i class="fas fa-phone"></i> ${listing.sellerPhone || 'N/A'}
              </div>
            </div>
          </div>
          
          ${isOwner && currentUser.userType === 'seller' ? 
            `
            <div class="owner-actions">
              <button class="owner-btn btn-edit" onclick="editListing('${listing.id}')">
                <i class="fas fa-edit"></i> Edit
              </button>
              <button class="owner-btn btn-delete" onclick="openDeleteModal('${listing.id}', '${listing.title}')">
                <i class="fas fa-trash"></i> Delete
              </button>
            </div>
            ` : 
            `
            
            <div class="action-buttons">
  <button class="btn btn-primary"
    onclick="placeOrder(
      '${listing.id}',
      '${listing.title}',
      ${listing.price},
      '${listing.sellerId}'
    )">
    <i class="fas fa-shopping-cart"></i> Order Now
  </button>

  <button class="btn btn-secondary"
    onclick="sendWhatsApp('${listing.sellerPhone}', '${listing.title}')">
    <i class="fab fa-whatsapp"></i> WhatsApp
  </button>
</div>
            `
          }
        </div>
      </div>
    `;
  }

  function editListing(listingId) {
    // Load listing data and populate form
    // You'll need to implement this function
    alert("Edit function to be implemented");
  }

  function openDeleteModal(listingId, listingTitle) {
    listingToDelete = listingId;
    document.getElementById('deleteMessage').textContent = 
      `Are you sure you want to delete "${listingTitle}"? This action cannot be undone.`;
    document.getElementById('deleteModal').style.display = 'flex';
  }

  function closeDeleteModal() {
    document.getElementById('deleteModal').style.display = 'none';
    listingToDelete = null;
  }

  function openSellModal() {
    if (!currentUser) {
      alert("Please login to sell pets");
      toggleAuthModal();
      return;
    }
    
    if (currentUser.userType !== 'seller') {
      alert("Only sellers can list pets. Please register as seller.");
      return;
    }
    
    document.getElementById('sellModal').style.display = 'flex';
    updatePriceDisplay();
  }

  function closeSellModal() {
    document.getElementById('sellModal').style.display = 'none';
    resetSellForm();
  }

  function resetSellForm() {
    document.getElementById('editListingId').value = '';
    document.getElementById('petTitle').value = '';
    document.getElementById('petCategory').value = '';
    document.getElementById('petPrice').value = '';
    document.getElementById('petDescription').value = '';
    document.getElementById('petLocation').value = '';
    document.getElementById('petPhone').value = '';
    uploadedImages = [];
    document.getElementById('imagePreview').innerHTML = '';
    
    // Reset modal title
    document.getElementById('sellModalTitle').textContent = "Sell Your Pet";
    document.getElementById('sellModalSubtitle').textContent = "List your pet in just 2 minutes";
    document.getElementById('submitListingBtn').innerHTML = '<i class="fas fa-paper-plane"></i> Publish Listing';
  }

  function updatePriceDisplay() {
    const price = parseFloat(document.getElementById('petPrice').value) || 0;
    const commission = price * (ADMIN_COMMISSION_RATE/100);
    const sellerGets = price - commission;
    
    const commissionInfo = document.getElementById('commissionInfo');
    if (price > 0) {
      commissionInfo.innerHTML = `
        <div style="background: #f8f9fa; padding: 10px; border-radius: 8px; border-left: 3px solid #ff9800;">
          <i class="fas fa-info-circle" style="color: #ff9800;"></i>
          <strong>Commission Details:</strong><br>
          ‚Ä¢ Listing Price: <strong>‡§∞‡•Å ${price.toLocaleString()}</strong><br>
          ‚Ä¢ Admin Commission (${ADMIN_COMMISSION_RATE}%): <strong>‡§∞‡•Å ${commission.toFixed(2)}</strong><br>
          ‚Ä¢ <strong style="color: var(--primary);">You Receive: ‡§∞‡•Å ${sellerGets.toLocaleString()}</strong>
        </div>
      `;
    } else {
      commissionInfo.innerHTML = `
        <div style="color: var(--text-light); font-size: 12px;">
          <i class="fas fa-info-circle"></i> Enter price to see commission details
        </div>
      `;
    }
  }

  function handleImageUpload(event) {
    const files = event.target.files;
    
    for (let i = 0; i < Math.min(files.length, 5 - uploadedImages.length); i++) {
      const file = files[i];
      const reader = new FileReader();
      
      reader.onload = function(e) {
        uploadedImages.push(e.target.result);
        updateImagePreview();
      }
      
      reader.readAsDataURL(file);
    }
    
    event.target.value = '';
  }

  function updateImagePreview() {
    const preview = document.getElementById('imagePreview');
    preview.innerHTML = '';
    
    uploadedImages.forEach((imgSrc, index) => {
      const imgContainer = document.createElement('div');
      imgContainer.style.position = 'relative';
      imgContainer.style.display = 'inline-block';
      imgContainer.style.margin = '5px';
      
      const img = document.createElement('img');
      img.src = imgSrc;
      img.style.width = '80px';
      img.style.height = '80px';
      img.style.objectFit = 'cover';
      img.style.borderRadius = '8px';
      img.style.border = '2px solid var(--border)';
      
      const removeBtn = document.createElement('button');
      removeBtn.innerHTML = '<i class="fas fa-times"></i>';
      removeBtn.style.cssText = `
        position: absolute;
        top: -5px;
        right: -5px;
        background: var(--danger);
        color: white;
        border: none;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        font-size: 10px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      `;
      removeBtn.onclick = function(e) {
        e.stopPropagation();
        uploadedImages.splice(index, 1);
        updateImagePreview();
      };
      
      imgContainer.appendChild(img);
      imgContainer.appendChild(removeBtn);
      preview.appendChild(imgContainer);
    });
  }

  function sendWhatsApp(phone, title) {
    if (!currentUser) {
      alert("Please login to contact sellers");
      toggleAuthModal();
      return;
    }
    
    const message = `Namaste! I'm interested in your "${title}" listing on ABI Fish & Pets. Is it still available?`;
    const encodedMessage = encodeURIComponent(message);
    const whatsappUrl = `https://wa.me/${phone}?text=${encodedMessage}`;
    
    window.open(whatsappUrl, '_blank');
    showNotification(`Opening WhatsApp for ${phone}...`, 'info');
  }

  function callSeller(phone) {
    if (!currentUser) {
      alert("Please login to contact sellers");
      toggleAuthModal();
      return;
    }
    
    if (confirm(`Call ${phone}?`)) {
      showNotification(`Calling ${phone}...`, 'info');
    }
  }

  function filterListings() {
    // This function needs your existing filtering logic
    // For now, just reload all listings
    loadListings();
  }

  function filterByCategory(category) {
    document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // Implement category filtering
    loadListings();
  }

  function showMyListings() {
    if (!currentUser) {
      alert("Please login first");
      toggleAuthModal();
      return;
    }
    
    if (currentUser.userType !== 'seller') {
      alert("Only sellers can view their listings");
      return;
    }

        // Filter to show only current user's listings
    const container = document.getElementById('listingsContainer');
    container.innerHTML = '<div style="grid-column:1/-1; text-align:center; padding:40px;"><i class="fas fa-spinner fa-spin"></i> Loading your listings...</div>';
    
    // You'll need to modify loadListings() to filter by sellerId
    // For now, just show a message
    container.innerHTML = `
      <div style="grid-column:1/-1; text-align:center; padding:40px; color:var(--text-light);">
        <i class="fas fa-list" style="font-size:50px;"></i>
        <h3>My Listings Feature</h3>
        <p>This feature will show only your listings.</p>
        <button class="btn btn-secondary" onclick="loadListings()" style="margin-top:20px;">
          <i class="fas fa-arrow-left"></i> Back to All Listings
        </button>
      </div>
    `;
  }

  function showUserMenu() {
    if (!currentUser) return;
    
    const menu = document.createElement('div');
    menu.style.cssText = `
      position: absolute;
      top: 60px;
      right: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
      padding: 15px;
      min-width: 200px;
      z-index: 2001;
      animation: fadeIn 0.2s ease;
    `;
    
    menu.innerHTML = `
      <div style="padding: 10px; border-bottom: 1px solid #eee;">
        <div style="font-weight: bold;">${currentUser.name}</div>
        <div style="font-size: 12px; color: #666;">${currentUser.email}</div>
        <div style="font-size: 11px; color: #888; margin-top: 5px;">
          <i class="fas fa-${currentUser.userType === 'seller' ? 'store' : 'user'}"></i>
          ${currentUser.userType === 'seller' ? 'Seller' : 'Customer'}
        </div>
      </div>
      <div style="padding: 10px;">
        <button onclick="showMyProfile()" style="width: 100%; padding: 10px; text-align: left; background: none; border: none; cursor: pointer;">
          <i class="fas fa-user-circle"></i> My Profile
        </button>
        ${currentUser.userType === 'seller' ? 
          `<button onclick="showMyListings()" style="width: 100%; padding: 10px; text-align: left; background: none; border: none; cursor: pointer;">
            <i class="fas fa-list"></i> My Listings
          </button>` : ''
        }
        <button onclick="logout()" style="width: 100%; padding: 10px; text-align: left; background: none; border: none; cursor: pointer; color: #f44336;">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    `;
    
    document.body.appendChild(menu);
    
    const closeMenu = function() {
      if (document.body.contains(menu)) {
        document.body.removeChild(menu);
        document.removeEventListener('click', closeMenu);
      }
    };
    
    setTimeout(closeMenu, 5000);
    document.addEventListener('click', closeMenu);
  }

  function showMyProfile() {
    if (!currentUser) return;
    
    alert(`My Profile\n\nName: ${currentUser.name}\nEmail: ${currentUser.email}\nPhone: ${currentUser.phone}\nAccount Type: ${currentUser.userType}`);
  }

  function showNotification(message, type) {
    const notification = document.createElement('div');
    notification.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      background: ${type === 'success' ? '#4caf50' : type === 'info' ? '#2196f3' : '#ff9800'};
      color: white;
      padding: 15px 25px;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      z-index: 3000;
      animation: slideInRight 0.3s ease;
      font-weight: 500;
      max-width: 400px;
    `;
    notification.innerHTML = `
      <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'info' ? 'info-circle' : 'exclamation-triangle'}"></i>
      ${message}
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.animation = 'slideOutRight 0.3s ease';
      setTimeout(() => notification.remove(), 300);
    }, 3000);
    
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideInRight {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOutRight {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `;
    document.head.appendChild(style);
  }

  // Utility functions
  function getCategoryIcon(category) {
    const icons = {
      'dog': 'fas fa-dog',
      'cat': 'fas fa-cat',
      'fish': 'fas fa-fish',
      'bird': 'fas fa-dove',
      'other': 'fas fa-paw'
    };
    return icons[category] || 'fas fa-paw';
  }

  function getCategoryColor(category) {
    const colors = {
      'dog': 'linear-gradient(45deg, #ffcc80, #ffb74d)',
      'cat': 'linear-gradient(45deg, #b39ddb, #9575cd)',
      'fish': 'linear-gradient(45deg, #80deea, #4fc3f7)',
      'bird': 'linear-gradient(45deg, #a5d6a7, #81c784)',
      'other': 'linear-gradient(45deg, #ffab91, #ff8a65)'
    };
    return colors[category] || 'linear-gradient(45deg, #e0e0e0, #bdbdbd)';
  }

  function getCategoryName(category) {
    const names = {
      'dog': 'Dog',
      'cat': 'Cat',
      'fish': 'Fish',
      'bird': 'Bird',
      'other': 'Other'
    };
    return names[category] || 'Pet';
  }

  // Make functions available globally
  window.toggleAuthModal = toggleAuthModal;
  window.switchAuthTab = switchAuthTab;
  window.login = login;
  window.register = register;
  window.logout = logout;
  window.submitListing = submitListing;
  window.confirmDelete = confirmDelete;
  window.openDeleteModal = openDeleteModal;
  window.closeDeleteModal = closeDeleteModal;
  window.openSellModal = openSellModal;
  window.closeSellModal = closeSellModal;
  window.handleImageUpload = handleImageUpload;
  window.sendWhatsApp = sendWhatsApp;
  window.callSeller = callSeller;
  window.filterByCategory = filterByCategory;
  window.showMyListings = showMyListings;
  window.showUserMenu = showUserMenu;
  window.showMyProfile = showMyProfile;
  window.editListing = editListing;
  window.placeOrder = placeOrder;

</script>
</body>
</html>
             
